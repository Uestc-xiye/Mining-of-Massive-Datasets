##  习题1.2.1

![在这里插入图片描述](https://img-blog.csdnimg.cn/30eb2b4378d5438a85ce9a8691ddfa6a.png)


每个人每100天当中有一天会去宾馆。

给定某天，任意一个人都决定去宾馆的概率为1/100=0.01。

给定某天，任意两个人都决定去宾馆的概率为 (0.01)<sup>2</sup>=0.0001。

宾馆总数为200000个。

给定某天，任意两个人都决定入住同一宾馆的概率为 0.0001/200000=5×10<sup>-10</sup>。

故，在任意给定的不同的三个日子里，两人入住同一宾馆的概率就是5×10<sup>-10</sup>的立方，即1.25×10<sup>-28</sup>。


在20亿的人员中，组队个数为(2×10<sup>9</sup>)<sup>2</sup>/2=2×10<sup>18</sup>。

而在2000天内，任意三天的组合个数为2000×1999×1998/3!=1331334000。

疑似作恶事件的期望数目应该是：2×10<sup>18</sup>×1331334000×1.25×10<sup>-28</sup>=0.3328。

也就是说，可能的嫌疑人员对的数目是0.3328。



##  !习题1.2.2
![在这里插入图片描述](https://img-blog.csdnimg.cn/c42d046dd2564098a85851a5fe22fca0.png)



假设：

1. 观察天数为1年（365天）。
2. 总人数为1亿。
3. 超市只有1个，有1000种商品。
4. 每人每年去超市100次，每次买10种商品。
5. 我们将对1年的超市购买记录进行核查。
6. 任意两个人在任意给定的一个日子里购买相同的10种商品，则这两个人是恐怖分子。



给定某天，任意一个人都决定去超市的概率为100/365=0.27。

给定某天，任意两个人都决定去超市的概率为 (100/365)<sup>2</sup>=0.0751。

任意两个人购买相同的10种商品的概率为(1/C<sup>10</sup><sub>1000</sub>)<sup>2</sup>=1.4412×10<sup>-47</sup>。

在1亿的人员中，组队个数为(1×10<sup>8</sup>)<sup>2</sup>/2=1×10<sup>16</sup>。

在1年中，任意一天的组合数是365。

疑似作恶事件的期望数目应该是：1×10<sup>16</sup>×365×0.0751×1.4412×10<sup>-47</sup>=3.9486×10<sup>-34</sup>。


也就是说，可能的嫌疑人员对的数目是3.9486×10<sup>-34</sup>，概率实在太低了，不能期望发现任意这类人员都是真正的恐怖分子。

##   习题1.3.1

![在这里插入图片描述](https://img-blog.csdnimg.cn/e3de8fad7538452bba81baa35dc8f517.png)



(a) IDF=log<sub>2</sub>(10<sup>7</sup>/40)=17.9≈18。

(b)IDF=log<sub>2</sub>(10<sup>7</sup>/10000)=9.97≈10。

##   习题1.3.2

![在这里插入图片描述](https://img-blog.csdnimg.cn/8759cc2b13374364ad7287b0d978076a.png)



IDF=log<sub>2</sub>(10<sup>7</sup>/320)≈14.93。

(a) TF=1/15, TF.IDF=TF×IDF=0.9954。

(b) TF=5/15=1/3, TF.IDF=TF×IDF=2.9863。


##   !习题1.3.3

![在这里插入图片描述](https://img-blog.csdnimg.cn/91a165b5f11546e29aa897317b655a91.png)




c=1（猜的）

##  习题1.3.4

![在这里插入图片描述](https://img-blog.csdnimg.cn/facf1b32bb53431cab9c436cbfbaa831.png)



(a) (1.01)<sup>500</sup>=(1+0.01)<sup>500</sup>≈e<sup>0.01×500</sup>=e<sup>5</sup>。

(b) (1.05)<sup>1000</sup>=(1+0.05)<sup>1000</sup>≈e<sup>0.05×1000</sup>=e<sup>50</sup>。

(c) (0.9)<sup>40</sup>=(1-0.1)<sup>1000</sup>≈e<sup>-0.1×40</sup>=e<sup>-4</sup>。


##  习题1.3.5






![在这里插入图片描述](https://img-blog.csdnimg.cn/1590d80ed28f4f0f916091193135b9f3.png)



(a) e<sup>1/10</sup>=1+0.1+(0.1)<sup>2</sup>/2+(0.1)<sup>3</sup>/6≈1.105。

(b) e<sup>-1/10</sup>=1-0.1+(-0.1)<sup>2</sup>/2+(-0.1)<sup>3</sup>/6≈0.905。

(c) e<sup>2</sup>=1+2+2<sup>2</sup>/2+2<sup>3</sup>/6≈7.389。

##  习题2.2.1
![在这里插入图片描述](https://img-blog.csdnimg.cn/7de7651d172a45cf88a4445e0184c962.png)( a )

不同的Reducer的时间差异会很大，因为在Map任务中不使用组合器的话，所有Map任务的输出都是键-值对：(w<sub>1</sub>,1), (w<sub>2</sub>,1),...,(w<sub>n</sub>,1)，在Shuffle操作后，相同键的键-值对完成分区，排序、分组后作为中间文件成为Reduce任务的输入，通常来说不同键的值表大小差距很大（频繁词汇和冷门词汇），导致不同的Reducer的时间差异会很大。

( b )

如果将Reducer组合成随机的10个任务，时间差距不会十分显著，因为通过使用比Reducer数目更少的Reduce任务，可以减少偏斜性（skew）带来的影响。通过使用比计算节点数目更多的Reduce任务，可以进一步减少偏斜性（skew），在这种情况下，长的Reduce任务可能占满某个计算节点，而几个更短的Reduce任务可以在单个计算节点上串行运行；而如果将Reducer组合成10000个Reduce任务，首先，增加Reduce任务数目会增加整个框架的开销，其次，每一个Reduce任务都要对应一个中间文件，这也会增加存储空间的开销，最后，通常来说不同键的值表大小差距很大，如果每一个Reducer都用一个单独的Reduce任务来完成，那么任务本身会表现出偏斜性（skew），即任务的完成时间差异很大。

( c ) 

假设我们在100个Map任务中使用组合器，那么上述时间的差异不会很显著。因为我们在对键-值对(w<sub>1</sub>,1), (w<sub>2</sub>,1),...,(w<sub>n</sub>,1)进行分组和聚合之前就应用了Reduce函数，单个Map任务产生的包含键w的键-值对可以组合成一个对(w,m)，其中m为w在该Map任务所处理文档集中的出现次数。由此可见，组合器通过减少需要发送到Reduce的数据量和所需时间来帮助提高MapReduce的效率。


##  习题2.3.1
![在这里插入图片描述](https://img-blog.csdnimg.cn/025d827c372b4e61bd29043f91c40e81.png)
( a ) 假定对关系R(B)施加运算γ<sub>MAX(B)</sub>( R )。

Map函数：对每个元组(b)，生成键-值对(1, b)。
Reduce函数：每个键1代表一个分组，即对与键1关联的字段B的值表[b<sub>1</sub>, b<sub>2</sub>, ... , b<sub>n</sub>]施加MAX操作。输出结果是(1, x)对，其中x是b<sub>1</sub>, b<sub>2</sub>, ... , b<sub>n</sub>中的最大值。



( b ) 假定对关系R(B)施加运算γ<sub>AVG(B)</sub>( R )。

Map函数：对每个元组(b)，生成键-值对(1, b, 1)。
Reduce函数：每个键1代表一个分组，即对与键1关联的字段B的值表[b<sub>1</sub>, b<sub>2</sub>, ... , b<sub>n</sub>]施加AVG操作，将b<sub>1</sub>, b<sub>2</sub>, ... , b<sub>n</sub>进行求和，记为sum，将第三个元素进行求和，记为n。输出结果是(b, x)对，其中x=sum/n。



( c ) 假定对关系R(B)施加运算γ<sub>θ(B)</sub>( R )。

Map函数：对每个元组(b)，生成键-值对(b, 1)。
Reduce函数：每个键b代表一个分组，将与键b关联的字段B的值表[1, 1, ... , 1]变为1。输出结果是(b, 1)对。


最后，将Reduce函数的输出结果的键提取出来，就每个整数只出现一次的整数集合。


( d ) 假定对关系R(B)施加运算γ<sub>θ(B)</sub>( R )。

Map函数：对每个元组(b)，生成键-值对(b, 1)。
Reduce函数：每个键b代表一个分组，将与键b关联的字段B的值表[1, 1, ... , 1]里面的值进行求和，记为conut_b。输出结果是(b, count_b)对。



##  习题2.3.2

![在这里插入图片描述](https://img-blog.csdnimg.cn/e38e67260c814da7be721758a4bfb30c.png)



设矩阵M<sub>r×c</sub>，其第i行第j列的元素记为m<sub>ij</sub>。


设有一个c维列向量v，其第j个元素记为v<sub>j</sub>。

于是，矩阵M和向量v的乘积结果是一个n维列向量x，其第i个元素为x<sub>i</sub>。

![在这里插入图片描述](https://img-blog.csdnimg.cn/78ae22865cdb4c70bb3bc64e0a464230.png)
设矩阵M在DFS中是显式存储的三元组(i, j, m<sub>ij</sub>)。


Map函数：首先以一个整体的方式读入v，每个Map任务将整个向量v和矩阵M的一个文件块作为输入。对每个矩阵元素m<sub>ij</sub>，Map任务会产生键-值对(i, m<sub>ij</sub>v<sub>j</sub>)。因此，计算x<sub>i</sub>的所有n个求和项m<sub>ij</sub>v<sub>j</sub>的键值都相同。

Reduce函数：Reduce函数简单地将所有与给定键i关联的值相加即可得到结果(i, x<sub>i</sub>)。






##  !习题2.3.3

![在这里插入图片描述](https://img-blog.csdnimg.cn/1755f7e6ec624a26b555bdd2cd247783.png)

(a) 假设关系R和S具有相同的模式。

Map函数：将每个输入元组t转变为键-值对(t,1)。
Reduce函数：每个键t代表一个分组，将与键t关联的值表[1, 1, ... , 1]里面的值进行求和，记为conut。输出结果是(t, count)对。count就是元组t在R和S中出现次数的总和。


(b) 假设关系R和S具有相同的模式。

Map函数：将每个关系R输入元组t转变为键-值对(t,(R,1))，每个关系S输入元组t转变为键-值对(t,(S,1))。
Reduce函数：每个键t代表一个分组，将与键t关联且同为R或S的值表[1, 1, ... , 1]里面的值进行求和，记为count_R或count_S。输出结果是(t, (R,count_R))对或(t, (S,count_S))。最后，得到键t相同的键-值对(t,count)，其中count为count_R和count_S之间的较小值，即count=MIN(count_R,count_S)。

(c) 假设关系R和S具有相同的模式。

Map函数：将每个关系R输入元组t转变为键-值对(t,(R,1))，将每个关系S输入元组t转变为键-值对(t,(S,1))。
Reduce函数：每个键t代表一个分组，将与键t关联且同为R或S的值表[1, 1, ... , 1]里面的值进行求和，记为count_R或count_S。输出结果是(t, (R,count_R))对或(t, (S,count_S))。然后，得到键t相同的键-值对(t,count)，其中count为count_R和count_S的差值，即count=count_R-count_S。最后，只输出count>0的键值对(t,count)。


##  !习题2.3.4


![在这里插入图片描述](https://img-blog.csdnimg.cn/02dd8d8c801e4d568717ad0337effbe7.png)

选择运算σ<sub>C</sub>R的MapReduce实现：



Map函数：对R中的每个元组t，检测它是否满足C。如果满足，则产生一个键-值对(t,t)。

Reduce函数：对任意Map任务产生的每个键t，将存在一个或多个键-值对(t,t)，Reduce函数将(t,[t,t,t,...,t])转变为(t,t)。这样就保证了无重复输出。













##  习题2.3.5

![在这里插入图片描述](https://img-blog.csdnimg.cn/d3933ec068364dfd94f05503a5d59e19.png)
Map函数：生成键-值对((b,c),((R,a),(S,d)))，对每一个键-值对检测它是否满足b<c。如果满足，则输出给Reduce函数。

Reduce函数：对任意Map任务产生的每个键-值对((b,c),((R,a),(S,d)))，Reduce函数将其转变为((b,c),(a,d))。最终输出为(a,b,c,d)。







##  !习题2.4.1
![在这里插入图片描述](https://img-blog.csdnimg.cn/09ec137fca9641db8e36c9a33d81b01a.png)

设总执行事件为T，则：

![在这里插入图片描述](https://img-blog.csdnimg.cn/006f6a1d40414ec7bbd2a3ad91c21ffd.png)


##  !习题2.4.2

![在这里插入图片描述](https://img-blog.csdnimg.cn/e430247d11a1489aaae43474d2fd0e11.png)

设一次超步的执行时间为t，设在两次建立检查点之间运行x次超步。

则两次检查点之间的期望执行时间为：
![在这里插入图片描述](https://img-blog.csdnimg.cn/04c1341f6f7f4126ba4cf49c049b3384.png)
要使ET最小，则x=pc。

>注：猜的。

##  习题2.5.1
![在这里插入图片描述](https://img-blog.csdnimg.cn/2c4bcd639bd24e68a5ff8ed7b0f2a624.png)
( a ) 设矩阵M<sub>n×n</sub>的规模是$n^2$。n维向量v的规模是$n$。

M和v的每个文件块传递给一个Map任务，因此所有Map任务的通信开销之和是$n^2+n$。
Map任务的输出经过集群的互连传递给Reduce任务，该通信的开销是$O(n^2+n)$。

总开销：$n^2+n+O(n^2+n)$。


( b ) 设关系R和S的规模分别是$r$和$s$。

总开销：$r+s+O(r+s)$。

( c ) 设关系R的规模分别是$r$。

总开销：$r+O(r)$。



( d ) 设矩阵M<sub>m×n</sub>的规模是$m×n$，矩阵M<sub>n×s</sub>的规模是$n×s$。

总开销：$m×n+n×s+O(m×n+n×s)$。

##  !习题2.5.2

![在这里插入图片描述](https://img-blog.csdnimg.cn/e7e593c98251449f8405499bc7bd5405.png)

Map任务的通信开销：$r+s+t$。

Reduce任务的通信开销：
1. $cr$
2. $as$
3. $bt$

满足限制条件$abc=k$，并且使$cr+as+bt$最小。


令函数$cr+as+bt-\lambda(abc-k)$对$a$,$b$,$c$的偏导数为0，即求解方程组：
![在这里插入图片描述](https://img-blog.csdnimg.cn/ef2d179823044cfcbcc8b30480070326.png)

得到：$s=\lambda bc$, $t=\lambda ac$, $r=\lambda ab$。

将3个等式对应的左边与左边相乘，右边与右边相乘有$rst=\lambda^3 a^2b^2c^2$。又由于$abc=k$，于是得到$rst=\lambda^3 k^2$，求得$\lambda=\sqrt[3]{\frac{rst}{k^2}}$。

因此，当$a=\sqrt[3]{\frac{kt^2}{rs}}$, $b=\sqrt[3]{\frac{kr^2}{st}}$, $c=\sqrt[3]{\frac{ks^2}{rt}}$时通信开销取最小值。

将上述取值代入公式$cr+as+bt$得到$\sqrt[3]{\frac{kt^2s^2}{r}}+\sqrt[3]{\frac{kr^2t^2}{s}}+\sqrt[3]{\frac{ks^2r^2}{t}}$。这就是Reduce任务的通信开销，然后加上Map任务的通信开销$r+s+t$。因此，总的通信开销是$r+s+t+\sqrt[3]{\frac{kt^2s^2}{r}}+\sqrt[3]{\frac{kr^2t^2}{s}}+\sqrt[3]{\frac{ks^2r^2}{t}}$。

##  !习题2.5.3

![在这里插入图片描述](https://img-blog.csdnimg.cn/cf48c5f47c5546268ecea80ceccbb1f7.png)

$a_1=a_2=...=a_n=k$


##  习题2.6.1

![在这里插入图片描述](https://img-blog.csdnimg.cn/707a2694fc704c81906d04c0ca9542ed.png)
( a ) 

设矩阵M<sub>n×n</sub>，其第i行第j列的元素记为m<sub>ij</sub>。


设有一个c维列向量v，其第j个元素记为v<sub>j</sub>。

于是，矩阵M和向量v的乘积结果是一个n维列向量x，其第i个元素为x<sub>i</sub>。

输入为：m<sub>ij</sub>和v<sub>j</sub>。

输出为：x<sub>i</sub>。

输入输出关系为：x<sub>i</sub>与m<sub>ij</sub>(1<=j<=n)和所有v<sub>j</sub>(1<=j<=n)连接。


( b ) 

设属性A，其第i个元素记为a<sub>i</sub>，其中1<=i<=a。
设属性B，其第i个元素记为b<sub>j</sub>，其中1<=j<=b。
设属性C，其第i个元素记为c<sub>k</sub>，其中1<=k<=c。


输入为：a<sub>i</sub>(1<=i<=a), b<sub>j</sub>(1<=j<=b), c<sub>k</sub>(1<=k<=c)。

输出为：(a<sub>i</sub>,b<sub>j</sub>,c<sub>k</sub>) (1<=i<=a, 1<=j<=b, 1<=k<=c)。

输入输出关系为：(a<sub>i</sub>,b<sub>j</sub>,c<sub>k</sub>)与a<sub>i</sub>，b<sub>j</sub>， b<sub>j’</sub> ，c<sub>k</sub>连接。其中，1<=i<=a，1<=j<=b，1<=j‘<=b，1<=k<=c，且b<sub>j</sub>=b<sub>j'</sub>。






( c ) 

设属性A，其第i个元素记为a<sub>i</sub>，其中1<=i<=a。
设属性B，其第i个元素记为b<sub>j</sub>，其中1<=j<=b。



输入为：a<sub>i</sub>(1<=i<=a), b<sub>j</sub>(1<=j<=b)。

输出为：(a<sub>i</sub>,max_b) (1<=i<=a)。

输入输出关系为：(a<sub>i</sub>,max_b)与所有和a<sub>i</sub>相等的输入及其对应b<sub>j</sub>连接。
##  !习题2.6.2

![在这里插入图片描述](https://img-blog.csdnimg.cn/f6aeb3ec886b4491b892f115f4599680.png)
(a)

单个Reducer覆盖的输出数目不可能超过

![在这里插入图片描述](https://img-blog.csdnimg.cn/1848365d1b9048adbc9a7648da5468c6.png)


(b) 

![在这里插入图片描述](https://img-blog.csdnimg.cn/417ffc7c59f7455184f7d20d76a0251f.png)


##  !!习题2.6.3

![在这里插入图片描述](https://img-blog.csdnimg.cn/643c1859ebac4a669b12a3719e43cea1.png)
>暂时不会。

##  习题3.1.1

设A={1, 2, 3, 4}，B={2, 3, 5, 7}，C={2, 4, 6}。

则，SIM(A, B)=2/6=1/3，SIM(A, C)=2/5，SIM(B, C)=1/6。

##  习题3.1.2

设A={1, 1, 1, 2}，B={1, 1, 2, 2, 3}，C={1, 2, 3, 4}。

则，SIM(A, B)=3/9=1/3，SIM(A, C)=2/8=1/4，SIM(B, C)=3/9=1/3。


##  !!习题3.1.3



![在这里插入图片描述](https://img-blog.csdnimg.cn/f0a4b20d61b44fda8ed664a4e18da7ea.png)

##  习题3.2.1

3.2节的第一句话的前10个3-shingle是：{"The", "he ", "e m", " mo", "mos", "ost",  "st ", "t e", " ef", "eff" }。

若采用基于词的构造方法，则为：{"The most effective", "most effective way", "effective way to", "way to  represent", "to represent documents", "represent documents as", "documents as  sets", "as sets for", "sets for the", "for the purpose"}。

## 习题3.2.2

若采用3.2.4节所示的基于停用词的shingle的表示方法，3.2节的第一句话的shingle有：{"The most effective", "way to represent", "as sets for", "for the purpose", "the purpose of", "of identifying lexically", "is to construct", "to construct from", "the document the", "the set of", "set of short", "of short strings", "it If we", "If we do", "we do so", "do so then", "so then documents", "as short as", "as sentences or", "or even phrases", "in their sets", "if those sentences", "in different orders", "in the two", "the two documents", "two documents In", "In this section", "we introduce the", "the simplest and", "and most common", "as well as", "as an interesting", "an interesting variation"}。

## 习题3.2.3

长度为n个字节的文档中k-shingle最多有2<sup>4*n</sup>个。


## 习题3.3.1

(a)
| 组合  | Jaccard相似度 |
| :---: | :-----------: |
| S1-S2 |      0.4      |
| S1-S3 |      0.4      |
| S1-S4 |      0.4      |
| S2-S3 |      0.3      |
| S2-S4 |      0.3      |
| S3-S4 |      0.4      |

!(b)

| 组合  | 比例 |
| :---: | :--: |
| S1-S2 | 0.4  |
| S1-S3 | 0.4  |
| S1-S4 | 0.4  |
| S2-S3 | 0.3  |
| S2-S4 | 0.3  |
| S3-S4 | 0.4  |




## 习题3.3.2

哈希函数：

|  行  |  S1  |  S2  |  S3  |  S4  | x+1 mod 5 | 3x+1 mod 5 | 2x+4 mod 5 | 3x-1 mod 5 |
| :--: | :--: | :--: | :--: | :--: | :-------: | :--------: | ---------- | ---------- |
|  0   |  1   |  0   |  0   |  1   |     1     |     1      | 4          | -1         |
|  1   |  0   |  0   |  1   |  0   |     2     |     4      | 1          | 2          |
|  2   |  0   |  1   |  0   |  1   |     3     |     2      | 3          | 0          |
|  3   |  1   |  0   |  1   |  1   |     4     |     0      | 0          | 3          |
|  4   |  0   |  0   |  1   |  0   |     0     |     3      | 2          | 1          |

1. 初始化签名矩阵：

   |      |  S1  |  S2  |  S3  |  S4  |
   | :--: | :--: | :--: | :--: | :--: |
   |  h1  |  ∞   |  ∞   |  ∞   |  ∞   |
   |  h2  |  ∞   |  ∞   |  ∞   |  ∞   |
   |  h3  |  ∞   |  ∞   |  ∞   |  ∞   |
   |  h4  |  ∞   |  ∞   |  ∞   |  ∞   |

2. 考虑第0行：

   |      |  S1  |  S2  |  S3  |  S4  |
   | :--: | :--: | :--: | :--: | :--: |
   |  h1  |  1   |  ∞   |  ∞   |  1   |
   |  h2  |  1   |  ∞   |  ∞   |  1   |
   |  h3  |  4   |  ∞   |  ∞   |  4   |
   |  h4  |  -1  |  ∞   |  ∞   |  -1  |

3. 考虑第1行：

   |      |  S1  |  S2  |  S3  |  S4  |
   | :--: | :--: | :--: | :--: | :--: |
   |  h1  |  1   |  ∞   |  2   |  1   |
   |  h2  |  1   |  ∞   |  4   |  1   |
   |  h3  |  4   |  ∞   |  1   |  4   |
   |  h4  |  -1  |  ∞   |  2   |  -1  |

4. 考虑第2行：

   |      |  S1  |  S2  |  S3  |  S4  |
   | :--: | :--: | :--: | :--: | :--: |
   |  h1  |  1   |  3   |  2   |  1   |
   |  h2  |  1   |  2   |  4   |  1   |
   |  h3  |  4   |  3   |  1   |  3   |
   |  h4  |  -1  |  0   |  2   |  -1  |

5. 考虑第3行：

   |      |  S1  |  S2  |  S3  |  S4  |
   | :--: | :--: | :--: | :--: | :--: |
   |  h1  |  1   |  3   |  2   |  1   |
   |  h2  |  0   |  2   |  0   |  0   |
   |  h3  |  0   |  3   |  0   |  0   |
   |  h4  |  -1  |  0   |  2   |  -1  |

6. 考虑第4行：

   |      |  S1  |  S2  |  S3  |  S4  |
   | :--: | :--: | :--: | :--: | :--: |
   |  h1  |  1   |  3   |  0   |  1   |
   |  h2  |  0   |  2   |  0   |  0   |
   |  h3  |  0   |  3   |  0   |  0   |
   |  h4  |  -1  |  0   |  1   |  -1  |

最终得到的最小哈希签名矩阵为：

|      |  S1  |  S2  |  S3  |  S4  |
| :--: | :--: | :--: | :--: | :--: |
|  h1  |  1   |  3   |  0   |  1   |
|  h2  |  0   |  2   |  0   |  0   |
|  h3  |  0   |  3   |  0   |  0   |
|  h4  |  -1  |  0   |  1   |  -1  |

## 习题3.3.3

(a)

哈希函数：

|  行  |  S1  |  S2  |  S3  |  S4  | 2x+1 mod 6 | 3x+2 mod 6 | 5x+2 mod 6 |
| :--: | :--: | :--: | :--: | :--: | :--------: | :--------: | :--------: |
|  0   |  0   |  1   |  0   |  1   |     1      |     2      |     2      |
|  1   |  0   |  1   |  0   |  0   |     3      |     5      |     1      |
|  2   |  1   |  0   |  0   |  1   |     5      |     2      |     0      |
|  3   |  0   |  0   |  1   |  0   |     1      |     5      |     5      |
|  4   |  0   |  0   |  1   |  1   |     3      |     2      |     4      |
|  5   |  1   |  0   |  0   |  0   |     5      |     5      |     3      |

1. 初始化签名矩阵：

   |      |  S1  |  S2  |  S3  |  S4  |
   | :--: | :--: | :--: | :--: | :--: |
   |  h1  |  ∞   |  ∞   |  ∞   |  ∞   |
   |  h2  |  ∞   |  ∞   |  ∞   |  ∞   |
   |  h3  |  ∞   |  ∞   |  ∞   |  ∞   |

2. 考虑第0行：

   |      |  S1  |  S2  |  S3  |  S4  |
   | :--: | :--: | :--: | :--: | :--: |
   |  h1  |  ∞   |  1   |  ∞   |  1   |
   |  h2  |  ∞   |  2   |  ∞   |  2   |
   |  h3  |  ∞   |  2   |  ∞   |  2   |

3. 考虑第1行：

   |      |  S1  |  S2  |  S3  |  S4  |
   | :--: | :--: | :--: | :--: | :--: |
   |  h1  |  ∞   |  1   |  ∞   |  1   |
   |  h2  |  ∞   |  2   |  ∞   |  2   |
   |  h3  |  ∞   |  1   |  ∞   |  2   |

4. 考虑第2行：

   |      |  S1  |  S2  |  S3  |  S4  |
   | :--: | :--: | :--: | :--: | :--: |
   |  h1  |  5   |  1   |  ∞   |  1   |
   |  h2  |  2   |  2   |  ∞   |  2   |
   |  h3  |  0   |  1   |  ∞   |  0   |

5. 考虑第3行：

   |      |  S1  |  S2  |  S3  |  S4  |
   | :--: | :--: | :--: | :--: | :--: |
   |  h1  |  5   |  1   |  1   |  1   |
   |  h2  |  2   |  2   |  5   |  2   |
   |  h3  |  0   |  1   |  5   |  0   |

6. 考虑第4行：

   |      |  S1  |  S2  |  S3  |  S4  |
   | :--: | :--: | :--: | :--: | :--: |
   |  h1  |  5   |  1   |  1   |  1   |
   |  h2  |  2   |  2   |  2   |  2   |
   |  h3  |  0   |  1   |  4   |  0   |

7. 考虑第5行：

   |      |  S1  |  S2  |  S3  |  S4  |
   | :--: | :--: | :--: | :--: | :--: |
   |  h1  |  5   |  1   |  1   |  1   |
   |  h2  |  2   |  2   |  2   |  2   |
   |  h3  |  0   |  1   |  4   |  0   |

最终得到的最小哈希签名矩阵为：

|      |  S1  |  S2  |  S3  |  S4  |
| :--: | :--: | :--: | :--: | :--: |
|  h1  |  5   |  1   |  1   |  1   |
|  h2  |  2   |  2   |  2   |  2   |
|  h3  |  0   |  1   |  4   |  0   |

(b)

这些哈希函数中只有h3是真正的排列转换。

(c)

| Jaccard相似度 | S1-S2 | S1-S3 | S1-S4 | S2-S3 | S2-S4 | S3-S4 |
| :-----------: | :---: | :---: | :---: | :---: | :---: | :---: |
|    估计值     |  1/3  |  1/3  |  2/3  |  2/3  |  2/3  |  2/3  |
|    真实值     |   0   |   0   |  1/4  |   0   |  1/4  |  1/4  |

Jaccard相似度的估计值和真实值差距很大。



## !习题3.3.4

S和T集合经随机排列之后得到的两个最小哈希值相等的概率等于S和T的Jaccard相似度。

## !习题3.3.5

两列的Jaccard相似度为0，说明两列经随机排列之后得到的两个最小哈希值相等的概率为0。

故最小哈希的方法总能得到正确的估计结果。


##  !!习题3.3.6
|  S1  |  S2  |
| :--: | :--: |
|  1   |  0   |
|  0   |  1   |
|  1   |  1   |
|  0   |  0   |
|  1   |  1   |

循环排列转换得到的Jaccard相似度：3/5

真正的Jaccard相似度：1/2

## !习题3.3.7
Map函数：
input：矩阵的行（或列）集合m~i~（huom~j~）、所有的哈希函数
output：一系列键-值对，键为(m~i~,h(m~i~))，即m~i~和与其对应的哈希函数，值为最小哈希签名



Reduce函数：
input：按键聚合的键-值对，值为最小哈希签名的集合
output：一系列键-值对，键为行号或列号，值为最小哈希签名


##  习题3.4.1



```c
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
int main(void)
{
    double r = 3;
    double b = 10;
    double s[] = {0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9};
    for (int i = 0; i < 9; i++)
        printf("%lf\n", 1 - pow(1 - pow(s[i], r), b));

    system("pause");
    return 0;
}
```

(1) r=3, b=10

| s    | 1-(1-s^r^)^b^ |
| ---- | ------------- |
| 0.1  | 0.009955      |
| 0.2  | 0.077181      |
| 0.3  | 0.239449      |
| 0.4  | 0.483871      |
| 0.5  | 0.736924      |
| 0.6  | 0.912267      |
| 0.7  | 0.985015      |
| 0.8  | 0.999234      |
| 0.9  | 0.999998      |


![在这里插入图片描述](https://img-blog.csdnimg.cn/7e6d298a2d464b12a5932352af2f880b.png)


(2) r=6, b=20

| s    | 1-(1-s^r^)^b^ |
| ---- | ------------- |
| 0.1  | 0.000020      |
| 0.2  | 0.001279      |
| 0.3  | 0.014479      |
| 0.4  | 0.078809      |
| 0.5  | 0.270187      |
| 0.6  | 0.615415      |
| 0.7  | 0.918186      |
| 0.8  | 0.997712      |
| 0.9  | 1.000000      |


![在这里插入图片描述](https://img-blog.csdnimg.cn/6be95b4f60e047289cf4b2291419d2aa.png)


(3) r=5, b=50

| s    | 1-(1-s^r^)^b^ |
| ---- | ------------- |
| 0.1  | 0.000020      |
| 0.2  | 0.001279      |
| 0.3  | 0.014479      |
| 0.4  | 0.078809      |
| 0.5  | 0.270187      |
| 0.6  | 0.615415      |
| 0.7  | 0.918186      |
| 0.8  | 0.997712      |
| 0.9  | 1.000000      |

![在这里插入图片描述](https://img-blog.csdnimg.cn/4b67168cfa434d818cc4ba7d4443aaa3.png)

##  !习题3.4.2

```c
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
int main(void)
{
    double r = 3;
    double b = 10;
    double s[] = {0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9};
    double true_s;
    double guess_s;
    for (int i = 0; i < 9; i++)
        printf("%lf\n", 1 - pow(1 - pow(s[i], r), b));

    true_s = pow(1 - pow(0.5, 1 / b), 1 / r);
    guess_s = pow(1 / b, 1 / r);
    printf("真实阈值：%lf\n", true_s);
    printf("估计阈值：%lf\n", guess_s);
    printf("误差：%lf\n", (guess_s - true_s) / true_s);
    system("pause");
    return 0;
}
```


(1) r=3, b=10


真实阈值：0.406088
估计阈值：0.464159
误差：0.143000


(2) r=6, b=20

真实阈值：0.569353
估计阈值：0.606962
误差：0.066055



(3) r=5, b=50



真实阈值：0.424394
估计阈值：0.457305
误差：0.077547


##  !习题3.4.3

当s^r^趋于0时，1-(1-s^r^)^b^≈1-e<sup>-s^r^*b</sup>。


##  !习题3.4.4
(a) 


Map函数：

input：签名矩阵元素，每个元素都是键-值对，键为列号，值为签名
output：键-值对，键为桶号，值为签名、列号


Reduce函数：

input：键-值对，键为桶号，值为签名、列号
output：键-值对，键为桶号，值为签名、列号i、满足j>i的列组成的列表

##  !习题3.5.1
( a ) max(x,y)

不满足非负、点到自身为0

( b ) diff(x,y)=|x-y|

是距离测度。

( c ) sum(x,y)=x+y
不满足非负、点到自身为0、三角不等式




##  习题3.5.2

$L_1=|5-8|+|6-2|+|7-4|=10$

$L_2=\sqrt{(5-8)^2+(6-2)^2+(7-4)^2}=\sqrt{34}$

##  !!习题3.5.3


如果$i$和$j$是任意的正整数，且$i$<$j$，那么任意两点的$L_i$范式距离一定大于它们的$L_j$范式距离。



##  习题3.5.4
(a) 1-3/5=0.4

(b) 1-0/6=1



##  习题3.5.5
( a ) $cos([3,-1,2],[-2,3,1])=\frac{-7}{14}=-\frac{1}{2}$

( b ) $cos([1,2,3],[2,4,6])=\frac{28}{28}=1$

( c ) $cos([5,0,-4],[-1,-6,2])=\frac{-13}{41}$

( d ) $cos([0,1,1,0,1,1],[0,0,1,0,0,0])=\frac{1}{2}$


##  !习题3.5.6

任意两个相同维度的布尔向量之间的夹角余弦一定非负，故它们的余弦距离最多为90度。
##  习题3.5.7
( a ) 4
( b ) 5
( c ) 6

##  !习题3.5.8
( a ) 4
( b ) 4
( c ) 4

##  !习题3.5.9


满足非负、点到自身距离为0、对称性、三角不等式，所以是一个距离测度。


##  习题3.5.10



设x~1~=000000，x~2~=110011，x~3~=010101，x~4~=011100


| 组合      | 海明距离 |
| --------- | -------- |
| x~1~-x~2~ | 4        |
| x~1~-x~3~ | 3        |
| x~1~-x~4~ | 3        |
| x~2~-x~3~ | 3        |
| x~2~-x~4~ | 5        |
| x~3~-x~4~ | 2        |


##  习题3.6.1


```c
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
int main(void)
{
    double p[] = {0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9};

    for (int i = 0; i < 9; i++)
        printf("%lf\n", pow(1-pow(1-pow(p[i],2),2),2));

    system("pause");
    return 0;
}
```

( a ) 2路与构造+3路或构造

| p    | 1-(1-p^2^)^3^ |
| ---- | ------------- |
| 0.1  | 0.029701      |
| 0.2  | 0.115264      |
| 0.3  | 0.246429      |
| 0.4  | 0.407296      |
| 0.5  | 0.578125      |
| 0.6  | 0.737856      |
| 0.7  | 0.867349      |
| 0.8  | 0.953344      |
| 0.9  | 0.993141      |


( b ) 3路或构造+2路与构造

| p    | (1-(1-p)^3^)^2^ |
| ---- | --------------- |
| 0.1  | 0.073441        |
| 0.2  | 0.238144        |
| 0.3  | 0.431649        |
| 0.4  | 0.614656        |
| 0.5  | 0.765625        |
| 0.6  | 0.876096        |
| 0.7  | 0.946729        |
| 0.8  | 0.984064        |
| 0.9  | 0.998001        |



( c ) 2路与构造+2路或构造+2路与构造


| p    | (1-(1-p^2^)^2^)^2^ |
| ---- | ------------------ |
| 0.1  | 0.000396           |
| 0.2  | 0.006147           |
| 0.3  | 0.029550           |
| 0.4  | 0.086671           |
| 0.5  | 0.191406           |
| 0.6  | 0.348572           |
| 0.7  | 0.547452           |
| 0.8  | 0.757596           |
| 0.9  | 0.929103           |

( c ) 2路或构造+2路与构造+2路或构造+2路与构造


| p    | (1-(1-1-(1-p^2^)^2^)^2^)^2^ |
| ---- | --------------------------- |
| 0.1  | 0.005026                    |
| 0.2  | 0.058760                    |
| 0.3  | 0.204800                    |
| 0.4  | 0.424358                    |
| 0.5  | 0.653824                    |
| 0.6  | 0.834169                    |
| 0.7  | 0.941774                    |
| 0.8  | 0.987745                    |
| 0.9  | 0.999208                    |


上述构造方法得到的函数族都是敏感的。而且，构造次数越多，对应S-曲线越陡峭，效果越好。

##  习题3.6.2

( a ) 令p=1-(1-p^2^)^3^，解得：p=0.3894

( b ) 令p=(1-(1-p)^3^)^2^，解得：p=0.1516

( c ) 令p=(1-(1-p^2^)^2^)^2^，无解

( d ) 令p=(1-(1-1-(1-p^2^)^2^)^2^)^2^，解得：p=0.5249


##  !习题3.6.3
图3-10：

![在这里插入图片描述](https://img-blog.csdnimg.cn/000b0f6c43be48cc8a51927a3cb1f543.png)
| p    | 斜率     |
| ---- | -------- |
| 0.2  | 4.000000 |
| 0.3  | 2.078125 |
| 0.4  | 1.309645 |
| 0.5  | 0.872527 |
| 0.6  | 0.564789 |
| 0.7  | 0.317882 |
| 0.8  | 0.122368 |

最大斜率：4.000000，对应p=0.2。


图3-11：

![在这里插入图片描述](https://img-blog.csdnimg.cn/5d4818d7f97747349ad1b063355bd8a7.png)


| p    | 斜率     |
| ---- | -------- |
| 0.2  | 7.678571 |
| 0.3  | 1.744033 |
| 0.4  | 0.721656 |
| 0.5  | 0.345819 |
| 0.6  | 0.564789 |
| 0.7  | 0.073766 |
| 0.8  | 0.026446 |



最大斜率：7.678571，对应p=0.2。


##  !!习题3.6.4
函数最大斜率的点就是函数二阶导数为0的点，且满足邻域左正右负。


例如，一个r路与构造+一个b路或构造的函数为：$1-(1-p^r)^b$

令其二阶导数为0：-b×(1-p^r^)×(-r×p^r-1^)=0，解得：$p=0$ 或 $p=1$。


##  习题3.7.1
设x~1~=000000，x~2~=110011，x~3~=010101，x~4~=011100。



| 组合      | 海明距离 |
| --------- | -------- |
| x~1~-x~2~ | 4        |
| x~1~-x~3~ | 3        |
| x~1~-x~4~ | 3        |
| x~2~-x~3~ | 3        |
| x~2~-x~4~ | 5        |
| x~3~-x~4~ | 2        |



6个函数中的3、5会判定它们是候选对。


##  习题3.7.2
( a ) 因为v~1~*x~1~=4，v~2~*x~1~=6，v~3~*x~1~=8，v~4~*x~1~=10，所以x~1~的梗概是[+1,+1,+1,+1]。

( b ) 因为v~1~*x~2~=-8，v~2~*x~2~=10，v~3~*x~2~=-4，v~4~*x~2~=6，所以x~2~的梗概是[-1,+1,-1,+1]。

( c ) 因为v~1~*x~3~=8，v~2~*x~3~=-10，v~3~*x~3~=4，v~4~*x~3~=-6，所以x~3~的梗概是[+1,-1,+1,-1]。




| 组合      | 估计夹角 | 真实夹角  |
| --------- | -------- | --------- |
| x~1~-x~2~ | 90°      | 74.9739°  |
| x~1~-x~3~ | 90°      | 105.0261° |
| x~2~-x~3~ | 180°     | 180°      |
##  习题3.7.3
| 随机向量 | 值            |
| -------- | ------------- |
| v~1~     | [+1,+1,+1,+1] |
| v~2~     | [-1,+1,+1,+1] |
| v~3~     | [+1,-1,+1,+1] |
| v~4~     | [+1,+1,-1,+1] |
| v~5~     | [+1,+1,+1,-1] |
| v~6~     | [-1,-1,+1,+1] |
| v~7~     | [-1,+1,-1,+1] |
| v~8~     | [-1,+1,+1,-1] |
| v~9~     | [+1,-1,-1,+1] |
| v~10~    | [+1,-1,+1,-1] |
| v~11~    | [+1,+1,-1,-1] |
| v~12~    | [-1,-1,-1,+1] |
| v~13~    | [-1,-1,+1,-1] |
| v~14~    | [-1,+1,-1,-1] |
| v~15~    | [+1,-1,-1,-1] |
| v~16~    | [-1,-1,-1,-1] |


x~1~的梗概是：[+1,+1,+1,+1,+1,+1,+1,+1,+1,-1,-1,-1,-1,-1,-1,-1]

x~2~的梗概是：[+1,+1,-1,+1,-1,+1,+1,-1,+1,-1,+1,+1,-1,-1,-1,-1]

x~3~的梗概是：[-1,-1,+1,-1,+1,-1,-1,+1,-1,+1,-1,-1,+1,+1,+1,+1]

| 组合      | 估计夹角 | 真实夹角  | 差异    |
| --------- | -------- | --------- | ------- |
| x~1~-x~2~ | 90°      | 74.9739°  | 20.04%  |
| x~1~-x~3~ | 90°      | 105.0261° | -14.31% |
| x~2~-x~3~ | 180°     | 180°      | 0       |



##  习题3.7.4

!(a) 条件：
1. -a+b+c+d>0
2. a-b+c+d>0
3. a+b-c+d>0
4. a+b+c-d>0






!!(b) 条件：

1. -a+b+c+d与-e+f+g+h同号
2. a-b+c+d与e-f+g+h同号
3. a+b-c+d与e+f-g+h同号
4. a+b+c-d与e+f+g-h同号


##  习题3.7.5

( a ) 


| 点           | x方向的桶号 | y方向的桶号 | z方向的桶号 |
| ------------ | ----------- | ----------- | ----------- |
| p~1~=(1,2,3) | 2           | 3           | 4           |
| p~2~=(0,2,4) | 1           | 3           | 5           |
| p~3~=(4,3,2) | 5           | 4           | 3           |



( b ) 


| 点           | x方向的桶号 | y方向的桶号 | z方向的桶号 |
| ------------ | ----------- | ----------- | ----------- |
| p~1~=(1,2,3) | 1           | 2           | 2           |
| p~2~=(0,2,4) | 1           | 2           | 3           |
| p~3~=(4,3,2) | 3           | 2           | 2           |


( c ) 

当a=1时，p~1~和p~2~是候选对。

当a=2时，p~1~和p~2~是候选对，p~2~和p~3~是候选对。


!( d ) 

对p~1~和p~2~来说，a=2或a>4时，它们是候选对。

对p~1~和p~3~来说，a>4时，它们是候选对。

对p~2~和p~3~来说，a>4时，它们是候选对。


##  习题3.8.1

363/365≈0.9945。

##  习题3.8.2
(a)


假阳率=1-(1-0.2^6^)^2048^=0.1228

假阴率=(1-0.2^3^*0.8^3^)^2048^=0.0224%



(b)


2路与构造：

假阳率=0.1228^2^=0.0151

假阴率=1-(1-0.0224%)^2^=0.0447%


可以看出，2路与构造再小幅提升假阴率的情况下，大幅度降低了假阳率。


##  习题3.8.3


n路或构造：


假阳率=1-(1-0.1228)^n^

假阴率=(0.0224%)^n^


##  习题3.8.4


(a) 假阴率=1-(1-0.0224%)^2^=0.0447%

(b) 假阳率=1-(1-0.2^6^)^2048^=0.1228


##  !习题3.8.5


n路或构造：

假阳率=1-(1-0.1228)^n^

假阴率=(0.0224%)^n^


设f(n)=假阳率+假阴率=1-(1-0.1228)^n^+(0.0224%)^n^

令f'(n)=0得n*(1-0.1228)^n-1^+n*(0.0224%)^n-1^=0，解得：n=0

且当n>0时，f'(n)>0，所以，n=2时f(n)取最小值0.2305。


##  习题3.9.1
(a) eqrtwy
(b) aiudfghjs


##  习题3.9.2


( a )


$L_t≤L_s/1-J=20/0.85=23.53$

$s$需要与排在它之后的所以长度为20、21、22、23的字符串进行比较。



( b )


$L_t≤L_s/1-J=20/0.95=21.05$

$s$需要与排在它之后的所以长度为20、21的字符串进行比较。

( c )


$L_t≤L_s/1-J=20/0.98=20.41$

$s$需要与排在它之后的所以长度为20的字符串进行比较。


##  习题3.9.3


( a )


$p=⌊(1-J)L_s⌋+1=⌊(1-0.85)×15⌋+1=3$，故需要对3个前缀符号进行索引。


( b )

$p=⌊(1-J)L_s⌋+1=⌊(1-0.95)×15⌋+1=1$，故需要对1个前缀符号进行索引。


!( c )

要满足$p=⌊(1-J)L_s⌋+1=⌊(1-J)×15⌋+1≤4$，

则$J$的取值范围是$[0.8,1]$。


##  习题3.9.4
设字符串$s$的第$i$个字符是$s_i$。


(a)

$p=⌊(1-J)L_s⌋+1=⌊(1-0.75)×12⌋+1=4$

需要比较$(s_1,1)$，$(s_1,2)$，$(s_1,3)$，$(s_1,4)$，$(s_2,2)$，$(s_2,3)$，$(s_2,4)$，$(s_3,3)$，$(s_3,4)$，$(s_4,4)$。

(b)

$p=⌊(1-J)L_s⌋+1=⌊(1-0.95)×12⌋+1=1$


需要比较$(s_1,1)$。


##  !习题3.9.5
(a)

当$J=0.9$、$L_s=L_t=9时$，$8/9<J$，
故$s$和$t$的第一个字符必须相等，$s$和$t$会被比较的概率是0.01。

(b)

当$J=0.9$、$L_s=L_t=10时$，$9/10=J$，
故$s$和$t$的第一个字符可以不相等，但随后的第二个字符必须相等，$s$和$t$会被比较的概率是$0.01+(1-0.01)*0.01=0.0199$。
##  习题3.9.6
(a) $L_s=20$，$J=0.8$

$p=⌊(1-J)L_s⌋+1=⌊(1-0.8)×20⌋+1=5$，所以接下来必须要考虑$s$的前5个前缀位置。

我们假定$s$的后缀长度为$p$，$t$的后缀长度为$q$。


$i=1$，这里$p=19$,因此$q≤19$。考虑所有的$q$值。

1. $q=19$，由于$20/(19+j)≥0.8$，因此$j$可以等于$1、2、3、4、5、6$
2. $q=18$，由于$19/(19+j)≥0.8$，因此$j$可以等于$1、2、3、4$
3. $q=17$，由于$18/(19+j)≥0.8$，因此$j$可以等于$1、2、3$
4. $q=16$，由于$17/(19+j)≥0.8$，因此$j$可以等于$1、2$
5. $q=15$，由于$16/(19+j)≥0.8$，因此$j$可以等于$1$
6. $q=14$，由于对任意整数$j$都有$15/(19+j)<0.8$，因此此时$j$不存在。对于更小的$q$值，情况也是如此。

$i=2$，这里$p=18$,因此$q≤18$。考虑所有的$q$值。

1. $q=18$，由于$19/(19+j)≥0.8$，因此$j$可以等于$1、2、3、4$
2. $q=17$，由于$18/(19+j)≥0.8$，因此$j$可以等于$1、2、3$
3. $q=16$，由于$17/(19+j)≥0.8$，因此$j$可以等于$1、2$
4. $q=15$，由于$16/(19+j)≥0.8$，因此$j$可以等于$1$
5. $q=14$，由于对任意整数$j$都有$15/(19+j)<0.8$，因此此时$j$不存在。对于更小的$q$值，情况也是如此。

$i=3$，这里$p=17$,因此$q≤17$。考虑所有的$q$值。

1. $q=17$，由于$18/(19+j)≥0.8$，因此$j$可以等于$1、2、3$
2. $q=16$，由于$17/(19+j)≥0.8$，因此$j$可以等于$1、2$
3. $q=15$，由于$16/(19+j)≥0.8$，因此$j$可以等于$1$
4. $q=14$，由于对任意整数$j$都有$15/(19+j)<0.8$，因此此时$j$不存在。对于更小的$q$值，情况也是如此。

$i=4$，这里$p=16$,因此$q≤16$。考虑所有的$q$值。

1. $q=16$，由于$17/(19+j)≥0.8$，因此$j$可以等于$1、2$
2. $q=15$，由于$16/(19+j)≥0.8$，因此$j$可以等于$1$
3. $q=14$，由于对任意整数$j$都有$15/(19+j)<0.8$，因此此时$j$不存在。对于更小的$q$值，情况也是如此。

$i=5$，这里$p=15$,因此$q≤15$。考虑所有的$q$值。


1. $q=15$，由于$16/(19+j)≥0.8$，因此$j$可以等于$1$
2. $q=14$，由于对任意整数$j$都有$15/(19+j)<0.8$，因此此时$j$不存在。对于更小的$q$值，情况也是如此。


(a) $L_s=20$，$J=0.9$

$p=⌊(1-J)L_s⌋+1=⌊(1-0.9)×20⌋+1=3$，所以接下来必须要考虑$3$的前5个前缀位置。

我们假定$s$的后缀长度为$p$，$t$的后缀长度为$q$。


$i=1$，这里$p=19$,因此$q≤19$。考虑所有的$q$值。

1. $q=19$，由于$20/(19+j)≥0.8$，因此$j$可以等于$1、2、3、4、5、6$
2. $q=18$，由于$19/(19+j)≥0.8$，因此$j$可以等于$1、2、3、4$
3. $q=17$，由于$18/(19+j)≥0.8$，因此$j$可以等于$1、2、3$
4. $q=16$，由于$17/(19+j)≥0.8$，因此$j$可以等于$1、2$
5. $q=15$，由于$16/(19+j)≥0.8$，因此$j$可以等于$1$
6. $q=14$，由于对任意整数$j$都有$15/(19+j)<0.8$，因此此时$j$不存在。对于更小的$q$值，情况也是如此。

$i=2$，这里$p=18$,因此$q≤18$。考虑所有的$q$值。

1. $q=18$，由于$19/(19+j)≥0.8$，因此$j$可以等于$1、2、3、4$
2. $q=17$，由于$18/(19+j)≥0.8$，因此$j$可以等于$1、2、3$
3. $q=16$，由于$17/(19+j)≥0.8$，因此$j$可以等于$1、2$
4. $q=15$，由于$16/(19+j)≥0.8$，因此$j$可以等于$1$
5. $q=14$，由于对任意整数$j$都有$15/(19+j)<0.8$，因此此时$j$不存在。对于更小的$q$值，情况也是如此。

$i=3$，这里$p=17$,因此$q≤17$。考虑所有的$q$值。

1. $q=17$，由于$18/(19+j)≥0.8$，因此$j$可以等于$1、2、3$
2. $q=16$，由于$17/(19+j)≥0.8$，因此$j$可以等于$1、2$
3. $q=15$，由于$16/(19+j)≥0.8$，因此$j$可以等于$1$
4. $q=14$，由于对任意整数$j$都有$15/(19+j)<0.8$，因此此时$j$不存在。对于更小的$q$值，情况也是如此。

##  习题4.2.1

( a ) 


对每个元组产生一个随机整数，范围是0~19，并当且仅当随机数为0是才存储该元组。


对存储下来的元组，以university属性分类，对于同一university属性的元组，统计不同的courseID数量，将元组数/courseID数，得到的就是每所大学在一个课程中的平均学生数目。


```sql
SELECT university, COUNT(*)/COUNT(DISTINCT courseID) AS avg_student
FROM Grades_hash_0
GROUP BY university
```

( b )

对每个元组产生一个随机整数，范围是0~19，并当且仅当随机数为0是才存储该元组。

对存储下来的元组，统计grade>=3.5的数量，除以元组数就得到GPA不低于3.5分的学生所占的比例。

```sql
SELECT COUNT(*) AS num
FROM Grades_hash_0
WHERE grade>=3.5

SELECT COUNT(*) AS sum
FROM Grades_hash_0

ratio=num/sum
```
( c )

对每个元组产生一个随机整数，范围是0~19，并当且仅当随机数为0是才存储该元组。

设置一个计数器count，初始化为0。

对存储下来的元组，以courseID属性分类，统计课程数量sum。对于同一courseID属性的元组，统计greade为A的数量和元组数量，若两者相除结果≥0.5，计数器count加1。

最终结果=count/sum。

```sql
count=0

for courseid in courseID:
	
	SELECT COUNT(*) AS num_A
	FROM Grades_hash_0
	WHERE grade='A'
	GROUP BY courseID

	SELECT COUNT(*) AS num
	FROM Grades_hash_0
	GROUP BY courseID
	
	if(num_A/num>=0.5)
		count++

SELECT COUNT(DISTINCT courseID) AS sum
FROM Grades_hash_0

ratio=count/sum
```


##  习题4.3.1

如果使用3个哈希函数，相当于往80亿个靶位上投30亿支飞镖，某个位为0的概率为e^-3/8^。一个非S中的元素若要成为伪正例的话，那么就必须在3个哈希函数的作用下都映射为1，而该概率为(1-e^-3/8^)^3^≈0.0306。

如果使用4个哈希函数，相当于往80亿个靶位上投40亿支飞镖，某个位为0的概率为e^-1/2^。一个非S中的元素若要成为伪正例的话，那么就必须在4个哈希函数的作用下都映射为1，而该概率为(1-e^-1/2^)^4^≈0.0240。

##  !习题4.3.2


一次哈希未命中的概率为$\frac{n/k-1}{n/k}$。

$k$次哈希都未命中的概率为$(\frac{n/k-1}{n/k})^k=(1-\frac{k}{n})^k≈e^\frac{-k^2}{n}$。


假阳率=$(1-e^\frac{-m}{n/k})^k$

使用$k$个哈希函数的方法的假阳率=$(1-e^\frac{-km}{n})^k$

这样做的假阳率与使用$k$个哈希函数的方法的假阳率相等。

##  !!习题4.3.3


设$f(k)=(1-e^\frac{-km}{n})^k$。


令$f'(k)=0$，即$(1-e^\frac{-km}{n})^k*ln(1-e^\frac{-km}{n})*(-e^\frac{-km}{n})*(-\frac{m}{n})=0$，解得：$k=ln(2)*\frac{n}{m}$。


##  习题4.4.1

( a ) h(x)=2x+1 mod 32


| 流中整数a | h(a) | h(a)二进制表示 | r(a) |
| --------- | ---- | -------------- | ---- |
| 3         | 7    | 00111          | 0    |
| 1         | 3    | 00011          | 0    |
| 4         | 9    | 01001          | 0    |
| 1         | 3    | 00011          | 0    |
| 5         | 11   | 01011          | 0    |
| 9         | 19   | 10011          | 0    |
| 2         | 5    | 00101          | 0    |
| 6         | 13   | 01101          | 0    |
| 5         | 11   | 01011          | 0    |


R=max~a~ r(a)=0，故估计的独立元素数目=2^R^=1。

( b ) h(x)=3x+7 mod 32



| 流中整数a | h(a) | h(a)二进制表示 | r(a) |
| --------- | ---- | -------------- | ---- |
| 3         | 16   | 10000          | 4    |
| 1         | 10   | 01010          | 1    |
| 4         | 19   | 10011          | 0    |
| 1         | 10   | 01010          | 1    |
| 5         | 22   | 10110          | 1    |
| 9         | 2    | 00010          | 1    |
| 2         | 13   | 01101          | 0    |
| 6         | 25   | 11001          | 0    |
| 5         | 22   | 10110          | 1    |


R=max~a~ r(a)=4，故估计的独立元素数目=2^R^=16。


( c ) h(x)=4x mod 32





| 流中整数a | h(a) | h(a)二进制表示 | r(a) |
| --------- | ---- | -------------- | ---- |
| 3         | 12   | 01100          | 2    |
| 1         | 4    | 00100          | 2    |
| 4         | 16   | 10000          | 4    |
| 1         | 4    | 00100          | 2    |
| 5         | 20   | 10100          | 2    |
| 9         | 4    | 00100          | 2    |
| 2         | 8    | 01000          | 3    |
| 6         | 24   | 11000          | 3    |
| 5         | 20   | 10100          | 2    |




R=max~a~ r(a)=4，故估计的独立元素数目=2^R^=16。


## !习题4.4.2

h(x)=2x+1 mod 32 不是一个好的哈希函数，因为对流中任意的整数$a$，$h(a)$一定是奇数，故$h(a)$的二进制表示的最后一位一定是$1$，因此，$r(a)$一定为0。



对一般的h(x)=ax+b mod 2^k^，建议尽量生成更多不同的哈希值（完美情况是使h(a)满足平均分布），使对独立元素的估计更加精准。


##  习题4.5.1

在这个流中，有3个元素出现了2次，有个1元素出现了3次。

二阶矩=3×2^2^+1×3^2^=21

三阶矩=3×2^3^+1×3^3^=51


##  !习题4.5.2

有$n$个元素，其中有$m$个独立元素。

这些元素最均匀的分布：m-1个元素出现$\frac{n-1}{m}$次，1个元素出现$\frac{n+m-1}{m}$次。这种情况下，奇异数是最小的，为$(m-1)×(\frac{n-1}{m})^2+1×(\frac{n+m-1}{m})^2=\frac{n^2-1}{m}+1$。


这些元素最极端的分布：1个元素出现n-m+1次，其余m-1个元素各出现1次。这种情况下，奇异数是最大的，为$1×(n-m+1)^2+(m-1)×1^2=n^2-(2n-m)×(m-1)$。


##  习题4.5.3

每个X~i~.value分别是：2，3，2，2，1，1，2，1，1。


##  习题4.5.4

每个变量的最终值是：2，3，2，2，1，1，2，1，1。

基于每个变量估计出的三阶矩分别是：63，171，63，63，9，9，63，9，9。

估计三阶矩的均值为：51。


三阶矩真实值=3×2^3^+1×3^3^=51。


误差为0。

##  习题4.5.5


当m=1时，1=1^2^，显然成立。

当m=i(i>=2)时，假设有1+...+(2i-1)=i^2^，
则，当m=i+1时，1+...+(2i-1)+(2i+1)=i^2^+2i+1=(i+1)^2^。

故，得证。


##  习题4.5.6


将v=X~i~.value转变为n×(v^4^-(v-1)^4^)。


##  习题4.6.1
当k=5时，估计值为3，包括2个大小为1的桶的大小，1个大小为2的桶的大小的一半，真实值为3，此时，估计值与真实值的差值为0。

当k=15时，估计值为10，包括2个大小为1的桶的大小，1个大小为2的桶的大小，1个大小为4的桶的大小以及1个大小为4的桶的大小的一半，真实值为9，此时，估计值与真实值的差值为1。
##  !习题4.6.2


假设位流左边还要无穷个元素。


![在这里插入图片描述](https://img-blog.csdnimg.cn/fa2c09e5bbcc4b21b9b1540697b532ec.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/3a8460097cad4a8984d7942d896f6946.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/6556f361e8874d309da667f39d613c5c.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/f35215c57ec44d869bf297cc67337fea.png)
##  习题4.6.3

第一个1到达窗口时，桶序列为：


![在这里插入图片描述](https://img-blog.csdnimg.cn/39448b7d323b4eecb5ac5586084e38eb.png)


第二个1到达窗口时，桶序列为：

![在这里插入图片描述](https://img-blog.csdnimg.cn/ea035d5965eb412aa78f96b5fb7db527.png)

第三个1到达窗口时，桶序列为：

![在这里插入图片描述](https://img-blog.csdnimg.cn/ecb7e6a005964681b392ee1abf53403d.png)

##  习题5.1.1
图5.7的转移矩阵为：

![在这里插入图片描述](https://img-blog.csdnimg.cn/bf0708de08a2435aa2a763b0b6978130.png)



不采用“抽税”法，我们从一个所有分量均为1/3的初始向量开始迭代计算，每次迭代都左乘转移矩阵。最终得到的向量序列为：



![在这里插入图片描述](https://img-blog.csdnimg.cn/521a9cbda42c45a9bf4a52d15f65b734.png)


##  习题5.1.2




假定β=0.8，向量v'的迭代公式为：

![在这里插入图片描述](https://img-blog.csdnimg.cn/41012c4676dc4d6aac53409eefd2b147.png)



我们从一个所有分量均为1/3的初始向量开始迭代计算，最终得到的向量序列为：



![在这里插入图片描述](https://img-blog.csdnimg.cn/6ace06b283ed41fd971b4cfdffcc70fe.png)

##  !习题5.1.3

PageRank向量的计算公式为：

![在这里插入图片描述](https://img-blog.csdnimg.cn/5038f5e9f7ad4bde914810179ced8b63.png)
假设初始向量v为：v=[x,x,...,x,y]^T^。

得：

![在这里插入图片描述](https://img-blog.csdnimg.cn/4717c7622f7b4b1db811afcbfe66ce30.png)
解得：


![在这里插入图片描述](https://img-blog.csdnimg.cn/4357cf6e10fa4414a646ad9a9f53ee9a.png)




##  !!习题5.1.4

Web是由n个节点组成的最大团。
##  !习题5.1.5


当n=0时，M^0^v的第2、3和4个分量显然相等。


假设当n=i时，M^i^v的第2、3和4个分量相等。
当n=i+1时，M^i+1^v=M*M^i^v，在M中，第2、3和4行完全一致，故M^i+1^v的第2、3和4个分量的计算结果继续保持相等。

得证。
##  习题5.1.6

在图5.9中，最左边有自环的节点的PageRank为1，其余所有节点的PageRank为1/2。


##  习题5.1.7

在图5.10中，最左边有自环的节点的PageRank为1，第i(i>=2)层的节点的PageRank为1/(3*2^i-2^)。



##  习题5.2.1
用矩阵表示，存储空间大小为：n*n。

设矩阵有x个非零元素。

用整数对列出矩阵中的非零元素，存储空间大小为：2x⌈log~2~n⌉。

要使2x⌈log~2~n⌉<=n^2^，则x<=(n^2^)/(2*⌈log~2~n⌉)。


即当非零元素比例<=n/(2*⌈log~2~n⌉)时，稀疏的表示方法节省空间。

##  习题5.2.2
(a) 图5-4


| 源网页 | 出度 | 目标网页 |
| ------ | ---- | -------- |
| A      | 3    | B, C, D  |
| B      | 2    | A, D     |
| C      | 1    | E        |
| D      | 2    | B, C     |


(b) 图5-7

| 源网页 | 出度 | 目标网页 |
| ------ | ---- | -------- |
| a      | 3    | a, b, c  |
| b      | 2    | a, c     |
| c      | 2    | b, c     |



##  习题5.2.3

将一个4节点的图5-3分割成4个2×2的方块(M~11~, M~12~, M~21~, M~22~)。


M~11~：

| 源网页 | 出度 | 目标网页 |
| ------ | ---- | -------- |
| A      | 3    | B        |
| B      | 2    | A        |


M~12~：

| 源网页 | 出度 | 目标网页 |
| ------ | ---- | -------- |
| D      | 2    | B        |


M~21~：

| 源网页 | 出度 | 目标网页 |
| ------ | ---- | -------- |
| A      | 3    | C, D     |
| B      | 2    | D        |

M~22~：

| 源网页 | 出度 | 目标网页 |
| ------ | ---- | -------- |
| D      | 2    | C        |


##  习题5.2.4
表示的空间大小为：k*(n/k+1)=n+k。



##  习题5.3.1


图5.15的转移矩阵为：


![在这里插入图片描述](https://img-blog.csdnimg.cn/2baf5bc7e94f45b5bfe06ddce4313c3a.png)
假设β=0.8。

(a) 仅包含A

则e~S~=[1,0,0,0]^T^，|S|=1。


PageRank向量的迭代公式为：
![在这里插入图片描述](https://img-blog.csdnimg.cn/c53fbe5432f8465a82c1c2e4ab294dbb.png)
我们从初始向量e~S~/|S|开始迭代计算，最终得到的向量序列为：

![在这里插入图片描述](https://img-blog.csdnimg.cn/a0f597bd371449b580eacc3a7743b1f9.png)


(b) 包含A和C

则e~S~=[1,0,1,0]^T^，|S|=2。


PageRank向量的迭代公式为：
![在这里插入图片描述](https://img-blog.csdnimg.cn/028e272eab1143c4abd8c43fe2bf870c.png)
我们从初始向量e~S~/|S|开始迭代计算，最终得到的向量序列为：



![在这里插入图片描述](https://img-blog.csdnimg.cn/450a5e740eaf4c2a81c213ad09eb8aa3.png)
##  习题 5.4.1

( a ) 每个支持网页只链向自己


此时，y=x+βm(1-β)/n。

( b ) 每个支持网页不链向任何网页


此时，y=x+βm(1-β)/n=x。


( c ) 每个支持网页同时链向自己和目标网页


此时，y=x+βm(βy/m+(1-β)/n)/2

解得：y=2x/(2-β^2^)+cm/n。


##  习题 5.4.2



| 节点 | PageRank |
| ---- | -------- |
| A    | 3/9      |
| B    | 2/9      |
| C    | 2/9      |
| D    | 2/9      |

(a)


| 节点 | TrustRank |
| ---- | --------- |
| A    | 0.2694    |
| B    | 0.3578    |
| C    | 0.1578    |
| D    | 0.2150    |


(b)


| 节点 | 垃圾质量 |
| ---- | -------- |
| A    | 0.1918   |
| B    | -0.6101  |
| C    | 0.2899   |
| D    | 0.0325   |



##  !习题 5.4.3


链向垃圾农场的全部网页，如果可以的话，双向链更佳。


存在好处，能提高自己网页的PageRank。

##  习题5.5.1

图5-1的链接矩阵L为：


![在这里插入图片描述](https://img-blog.csdnimg.cn/5b626edce4d04f65a0331f07d57b4772.png)


给出2个公式：
1. a=L^T^h，然后归一化
2. h=La，然后归一化



最开始h向量中的所有分量都是1。计算过程如下：



![在这里插入图片描述](https://img-blog.csdnimg.cn/20e80593878049e7b336dc19005e1293.png)

##  !习题5.5.2



图5-9的链接矩阵L为：

![在这里插入图片描述](https://img-blog.csdnimg.cn/5e847e52d45243b5a6fb035b554bc6bc.png)

设迭代次数为x。

导航度向量h=[1, 1/2^x^, 1/2^x^, 1/2^x^, 0]


权威度向量a=[1, 1, 1/2^x^, 1/2^x^, 1/2^x^]

##  习题6.1.1

程序：

```py
# 购物篮T
T = []
# 初始化购物篮T
for value in range(1, 101):
    t = []
    for i in range(1, value + 1):
        if value % i == 0:
            t.append(i)
    T.append(t)
# 打印购物篮T
print("\n购物篮T: " + str(T))

# 候选1项集C1，key为项集，value为该项集对应的支持度
C1 = {}
# 求C1
for i in range(1, 101):
    count = 0
    for t in T:
        if i in t:
            count += 1
    C1[i] = count
# 打印候选1项集C1
print("\n候选1项集C1: " + str(C1))

# 支持度阈值s
s = 5
# 频繁1项集L1，key为项集，value为该项集对应的支持度
L1 = {}
# 求L1
for key, value in C1.items():
    if value >= 5:
        L1[key] = value
# 打印频繁1项集L1
print("\n频繁1项集L1: " + str(L1))

# 候选2项集C2，key为项集，value为该项集对应的支持度
C2 = {}
for i in range(1, 21):
    for j in range(1, 21):
        if i == j:
            continue
        count = 0
        pair = f"[{i}, {j}]"
        for t in T:
            if i in t and j in t:
                count += 1
        C2[pair] = count
# 打印候选2项集C2
print("\n候选2项集C2: " + str(C2))

# 支持度阈值s
s = 5
# 频繁2项集L2，key为项集，value为该项集对应的支持度
L2 = {}
# 求L2
for key, value in C2.items():
    if value >= 5:
        L2[key] = value
# 打印频繁2项集L2
print("\n频繁2项集L2: " + str(L2))

# 求所有购物篮中项的数目之和
sum = 0
for t in T:
    for t_value in t:
        sum += 1
print(f"\n所有购物篮中项的数目之和为：{sum}。")

# 求所有购物篮中最大的购物篮，即元素个数最多的购物篮
# t_len存储T中每个购物篮t的元素个数
t_len = []
for t in T:
    t_len.append(len(t))
# print(t_len)
max_t_len = max(t_len)
print(f"\n在最大的购物篮中，元素个数为：{max_t_len}。\n它们分别是：")
for i in range(100):
    if t_len[i] == max_t_len:
        print(f"购物篮t{i}：{T[i]}")

```


运行结果：

![在这里插入图片描述](https://img-blog.csdnimg.cn/530c421db9cb4343b3bf3ee5c69e3623.png)

( a ) 如果支持度阈值是5，求频繁1项集L<sub>1</sub>


L<sub>1</sub> = {'1': 100, '2': 50, '3': 33, '4': 25, '5': 20, '6': 16, '7': 14, '8': 12, '9': 11, '10': 10, '11': 9, '12': 8, '13': 7, '14': 7, '15': 6, '16': 6, '17': 5, '18': 5, '19': 5, '20': 5}

这是一个字典，其中 key为项集，value为该项集对应的支持度。

( b ) 如果支持度阈值是5，求频繁2项集L<sub>2</sub>
L<sub>2</sub> = {'[1, 2]': 50, '[1, 3]': 33, '[1, 4]': 25, '[1, 5]': 20, '[1, 6]': 16, '[1, 7]': 14, '[1, 8]': 12, '[1, 9]': 11, '[1, 10]': 10, '[1, 11]': 9, '[1, 12]': 8, '[1, 13]': 7, '[1, 14]': 7, '[1, 15]': 6, '[1, 16]': 6, '[1, 17]': 5, '[1, 18]': 5, '[1, 19]': 5, '[1, 20]': 5, '[2, 3]': 16, '[2, 4]': 25, '[2, 5]': 10, '[2, 6]': 16, '[2, 7]': 7, '[2, 8]': 12, '[2, 9]': 5, '[2, 10]': 10, '[2, 12]': 8, '[2, 14]': 7, '[2, 16]': 6, '[2, 18]': 5, '[2, 20]': 5, '[3, 4]': 8, '[3, 5]': 6, '[3, 6]': 16, '[3, 9]': 11, '[3, 12]': 8, '[3, 15]': 6, '[3, 18]': 5, '[4, 5]': 5, '[4, 6]': 8, '[4, 8]': 12, '[4, 10]': 5, '[4, 12]': 8, '[4, 16]': 6, '[4, 20]': 5, '[5, 10]': 10, '[5, 15]': 6, '[5, 20]': 5, '[6, 9]': 5, '[6, 12]': 8, '[6, 18]': 5, '[7, 14]': 7, '[8, 16]': 6, '[9, 18]': 5, '[10, 20]': 5}


这是一个字典，其中 key为项集，value为该项集对应的支持度。

( c ) 所有购物篮中项的数目之和是多少？

所有购物篮中项的数目之和为：482。

##  !习题6.1.2
问题：对于习题6.1.1中的项-购物篮数据，哪个购物篮是最大的？




在最大的购物篮中，元素个数为：12。
它们分别是：
购物篮t59：[1, 2, 3, 4, 5, 6, 10, 12, 15, 20, 30, 60]
购物篮t71：[1, 2, 3, 4, 6, 8, 9, 12, 18, 24, 36, 72]
购物篮t83：[1, 2, 3, 4, 6, 7, 12, 14, 21, 28, 42, 84]
购物篮t89：[1, 2, 3, 5, 6, 9, 10, 15, 18, 30, 45, 90]
购物篮t95：[1, 2, 3, 4, 6, 8, 12, 16, 24, 32, 48, 96]


##  习题6.1.3

只需要修改一下生成购物篮T的代码即可。

程序：

```py
# 购物篮T
T = []
# 初始化购物篮T
for i in range(1, 101):
    t = []
    for value in range(i, 101):
        if value % i == 0:
            t.append(value)
    T.append(t)
# 打印购物篮T
print("\n购物篮T: " + str(T))

# 候选1项集C1，key为项集，value为该项集对应的支持度
C1 = {}
# 求C1
for i in range(1, 101):
    count = 0
    for t in T:
        if i in t:
            count += 1
    C1[str(i)] = count
# 打印候选1项集C1
print("\n候选1项集C1: " + str(C1))

# 支持度阈值s
s = 5
# 频繁1项集L1，key为项集，value为该项集对应的支持度
L1 = {}
# 求L1
for key, value in C1.items():
    if value >= 5:
        L1[key] = value
# 打印频繁1项集L1
print("\n频繁1项集L1: " + str(L1))

# 候选2项集C2，key为项集，value为该项集对应的支持度
C2 = {}
for i in range(1, 21):
    for j in range(i, 21):
        if i == j:
            continue
        count = 0
        pair = f"[{i}, {j}]"
        for t in T:
            if i in t and j in t:
                count += 1
        C2[pair] = count
# 打印候选2项集C2
print("\n候选2项集C2: " + str(C2))

# 支持度阈值s
s = 5
# 频繁2项集L2，key为项集，value为该项集对应的支持度
L2 = {}
# 求L2
for key, value in C2.items():
    if value >= 5:
        L2[key] = value
# 打印频繁2项集L2
print("\n频繁2项集L2: " + str(L2))

# 求所有购物篮中项的数目之和
sum = 0
for t in T:
    for t_value in t:
        sum += 1
print(f"\n所有购物篮中项的数目之和为：{sum}。")

# 求所有购物篮中最大的购物篮，即元素个数最多的购物篮
# t_len存储T中每个购物篮t的元素个数
t_len = []
for t in T:
    t_len.append(len(t))
# print(t_len)
max_t_len = max(t_len)
print(f"\n在最大的购物篮中，元素个数为：{max_t_len}。\n它是：")
for i in range(100):
    if t_len[i] == max_t_len:
        print(f"购物篮t{i}：{T[i]}")

```

( a ) 如果支持度阈值是5，求频繁1项集L<sub>1</sub>


L<sub>1</sub> = {'12': 6, '16': 5, '18': 6, '20': 6, '24': 8, '28': 6, '30': 8, '32': 6, '36': 9, '40': 8, '42': 8, '44': 6, '45': 6, '48': 10, '50': 6, '52': 6, '54': 8, '56': 8, '60': 12, '63': 6, '64': 7, '66': 8, '68': 6, '70': 8, '72': 12, '75': 6, '76': 6, '78': 8, '80': 10, '81': 5, '84': 12, '88': 8, '90': 12, '92': 6, '96': 12, '98': 6, '99': 6, '100': 9}


这是一个字典，其中 key为项集，value为该项集对应的支持度。

( b ) 如果支持度阈值是5，求频繁2项集L<sub>2</sub>

L<sub>2</sub> = {}

这是一个空字典，说明当支持度阈值是5时，频繁2项集L2为空集，算法到此结束。

( c ) 所有购物篮中项的数目之和是多少？

所有购物篮中项的数目之和为：482。


对于习题6.1.3中的项-购物篮数据，哪个购物篮是最大的？

在最大的购物篮中，元素个数为：100。
它是：
购物篮t0：[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100]

##  !习题6.1.4


每个项在购物篮中出现的概率的下界为1/10，因为支持度阈值为购物篮的1%，所以每个项的支持度都大于支持度阈值，故1-频繁项集L~1~为{1}，{2}，...，{10}。

##  习题6.1.5
习题6.1.1的购物篮T: [[1], [1, 2], [1, 3], [1, 2, 4], [1, 5], [1, 2, 3, 6], [1, 7], [1, 2, 4, 8], [1, 3, 9], [1, 2, 5, 10], [1, 11], [1, 2, 3, 4, 6, 12], [1, 13], [1, 2, 7, 14], [1, 3, 5, 15], [1, 2, 4, 8, 16], [1, 17], [1, 2, 3, 6, 9, 18], [1, 19], [1, 2, 4, 5, 10, 20], [1, 3, 7, 21], [1, 2, 11, 22], [1, 23], [1, 2, 3, 4, 6, 8, 12, 24], [1, 5, 25], [1, 2, 13, 26], [1, 3, 9, 27], [1, 2, 4, 7, 14, 28], [1, 29], [1, 2, 3, 5, 6, 10, 15, 30], [1, 31], [1, 2, 4, 8, 16, 32], [1, 3, 11, 33], [1, 2, 17, 34], [1, 5, 7, 35], [1, 2, 3, 4, 6, 9, 12, 18, 36], [1, 37], [1, 2, 19, 38], [1, 3, 13, 39], [1, 2, 4, 5, 8, 10, 20, 40], [1, 41], [1, 2, 3, 6, 7, 14, 21, 42], [1, 43], [1, 2, 4, 11, 22, 44], [1, 3, 5, 9, 15, 45], [1, 2, 23, 46], [1, 47], [1, 2, 3, 4, 6, 8, 12, 16, 24, 48], [1, 7, 49], [1, 2, 5, 10, 25, 50], [1, 3, 17, 51], [1, 2, 4, 13, 26, 52], [1, 53], [1, 2, 3, 6, 9, 18, 27, 54], [1, 5, 11, 55], [1, 2, 4, 7, 8, 14, 28, 56], [1, 3, 19, 57], [1, 2, 29, 58], [1, 59], [1, 2, 3, 4, 5, 6, 10, 12, 15, 20, 30, 60], [1, 61], [1, 2, 31, 62], [1, 3, 7, 9, 21, 63], [1, 2, 4, 8, 16, 32, 64], [1, 5, 13, 65], [1, 2, 3, 6, 11, 22, 33, 66], [1, 67], [1, 2, 4, 17, 34, 68], [1, 3, 23, 69], [1, 2, 5, 7, 10, 14, 35, 70], [1, 71], [1, 2, 3, 4, 6, 8, 9, 12, 18, 24, 36, 72], [1, 73], [1, 2, 37, 74], [1, 3, 5, 15, 25, 75], [1, 2, 4, 19, 38, 76], [1, 7, 11, 77], [1, 2, 3, 6, 13, 26, 39, 78], [1, 79], [1, 2, 4, 5, 8, 10, 16, 20, 40, 80], [1, 3, 9, 27, 81], [1, 2, 41, 82], [1, 83], [1, 2, 3, 4, 6, 7, 12, 14, 21, 28, 42, 84], [1, 5, 17, 85], [1, 2, 43, 86], [1, 3, 29, 87], [1, 2, 4, 8, 11, 22, 44, 88], [1, 89], [1, 2, 3, 5, 6, 9, 10, 15, 18, 30, 45, 90], [1, 7, 13, 91], [1, 2, 4, 23, 46, 92], [1, 3, 31, 93], [1, 2, 47, 94], [1, 5, 19, 95], [1, 2, 3, 4, 6, 8, 12, 16, 24, 32, 48, 96], [1, 97], [1, 2, 7, 14, 49, 98], [1, 3, 9, 11, 33, 99], [1, 2, 4, 5, 10, 20, 25, 50, 100]]


(a) {5, 7} → 2

可信度为1/2。


(b) {2, 3, 4} → 5

可信度为1/8。




##  习题6.1.6
习题6.1.3的购物篮T: [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100], [2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100], [3, 6, 9, 12, 15, 18, 21, 24, 27, 30, 33, 36, 39, 42, 45, 48, 51, 54, 57, 60, 63, 66, 69, 72, 75, 78, 81, 84, 87, 90, 93, 96, 99], [4, 8, 12, 16, 20, 24, 28, 32, 36, 40, 44, 48, 52, 56, 60, 64, 68, 72, 76, 80, 84, 88, 92, 96, 100], [5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100], [6, 12, 18, 24, 30, 36, 42, 48, 54, 60, 66, 72, 78, 84, 90, 96], [7, 14, 21, 28, 35, 42, 49, 56, 63, 70, 77, 84, 91, 98], [8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96], [9, 18, 27, 36, 45, 54, 63, 72, 81, 90, 99], [10, 20, 30, 40, 50, 60, 70, 80, 90, 100], [11, 22, 33, 44, 55, 66, 77, 88, 99], [12, 24, 36, 48, 60, 72, 84, 96], [13, 26, 39, 52, 65, 78, 91], [14, 28, 42, 56, 70, 84, 98], [15, 30, 45, 60, 75, 90], [16, 32, 48, 64, 80, 96], [17, 34, 51, 68, 85], [18, 36, 54, 72, 90], [19, 38, 57, 76, 95], [20, 40, 60, 80, 100], [21, 42, 63, 84], [22, 44, 66, 88], [23, 46, 69, 92], [24, 48, 72, 96], [25, 50, 75, 100], [26, 52, 78], [27, 54, 81], [28, 56, 84], [29, 58, 87], [30, 60, 90], [31, 62, 93], [32, 64, 96], [33, 66, 99], [34, 68], [35, 70], [36, 72], [37, 74], [38, 76], [39, 78], [40, 80], [41, 82], [42, 84], [43, 86], [44, 88], [45, 90], [46, 92], [47, 94], [48, 96], [49, 98], [50, 100], [51], [52], [53], [54], [55], [56], [57], [58], [59], [60], [61], [62], [63], [64], [65], [66], [67], [68], [69], [70], [71], [72], [73], [74], [75], [76], [77], [78], [79], [80], [81], [82], [83], [84], [85], [86], [87], [88], [89], [90], [91], [92], [93], [94], [95], [96], [97], [98], [99], [100]]



(a) {24, 60} → 8

可信度为3/6=1/2。


(b) {2, 3, 4} → 5

可信度为1。


##  !!习题6.1.7



(a) 习题6.1.1中的数据

因为所有质数的公因数只有1和它本身。

所以，{a} → 1是可信度为100%的关联规则，其中a为1到100的质数。

(b)习题6.1.3中的数据

{2, 3, 4} → 5

在习题6.1.3产生的购物篮中，第一个购物篮包含1到100的所有元素。

设U为1到100构成的集合，i为1到100的随机数。

则U-i → i是可信度为100%的关联规则。

##  !习题6.1.8


对于习题6.1.4的数据，对于任意的关联规则I → j，其可信度等于包含j的购物篮的比例，所以I → j的兴趣度为0。


>注：瞎写的。


##  习题6.2.1

a[100]存放的是{7, 8}项对的计数值。



##  !习题6.2.2

显然，k是否是整数与j无关，我们对i分情况讨论：
1. i为奇数，则i-1为偶数，所以(i-1)(n-i/2)是整数，故k是整数；
2. i为偶数，则i-1和n-i/2都是整数，所以k是整数。



综上，k必然是整数。




##  !习题6.2.3

( a ) 空间大小=4bits×I*(I-1)/2=2*I(I-1)bits。

( b ) 数目为$C_I^K$。

( c ) 如果在所有可能出现的$C_n^2$个项对中在购物篮出现的比例显著小于1/3，那么三元组方式所需的空间小于三角矩阵方法。


##  !!习题6.2.4

将两个相同的三角矩阵作笛卡尔积，每个集合中相同元素只保留一个，保留那些互异的三元素集合，再把它们安排到一个一维数组中。



##  !习题6.2.5


(a)

{1, 2, 3, 5}

(b)

{60}，{72}，{84}，{90}，{96}


##  习题6.2.6


(a)

购物篮T: 
[[1], [1, 2], [1, 3], [1, 2, 4], [1, 5], [1, 2, 3, 6], [1, 7], [1, 2, 4, 8], [1, 3, 9], [1, 2, 5, 10], [1, 11], [1, 2, 3, 4, 6, 12], [1, 13], [1, 2, 7, 14], [1, 3, 5, 15], [1, 2, 4, 8, 16], [1, 17], [1, 2, 3, 6, 9, 18], [1, 19], [1, 2, 4, 5, 10, 20], [1, 3, 7, 21], [1, 2, 11, 22], [1, 23], [1, 2, 3, 4, 6, 8, 12, 24], [1, 5, 25], [1, 2, 13, 26], [1, 3, 9, 27], [1, 2, 4, 7, 14, 28], [1, 29], [1, 2, 3, 5, 6, 10, 15, 30], [1, 31], [1, 2, 4, 8, 16, 32], [1, 3, 11, 33], [1, 2, 17, 34], [1, 5, 7, 35], [1, 2, 3, 4, 6, 9, 12, 18, 36], [1, 37], [1, 2, 19, 38], [1, 3, 13, 39], [1, 2, 4, 5, 8, 10, 20, 40], [1, 41], [1, 2, 3, 6, 7, 14, 21, 42], [1, 43], [1, 2, 4, 11, 22, 44], [1, 3, 5, 9, 15, 45], [1, 2, 23, 46], [1, 47], [1, 2, 3, 4, 6, 8, 12, 16, 24, 48], [1, 7, 49], [1, 2, 5, 10, 25, 50], [1, 3, 17, 51], [1, 2, 4, 13, 26, 52], [1, 53], [1, 2, 3, 6, 9, 18, 27, 54], [1, 5, 11, 55], [1, 2, 4, 7, 8, 14, 28, 56], [1, 3, 19, 57], [1, 2, 29, 58], [1, 59], [1, 2, 3, 4, 5, 6, 10, 12, 15, 20, 30, 60], [1, 61], [1, 2, 31, 62], [1, 3, 7, 9, 21, 63], [1, 2, 4, 8, 16, 32, 64], [1, 5, 13, 65], [1, 2, 3, 6, 11, 22, 33, 66], [1, 67], [1, 2, 4, 17, 34, 68], [1, 3, 23, 69], [1, 2, 5, 7, 10, 14, 35, 70], [1, 71], [1, 2, 3, 4, 6, 8, 9, 12, 18, 24, 36, 72], [1, 73], [1, 2, 37, 74], [1, 3, 5, 15, 25, 75], [1, 2, 4, 19, 38, 76], [1, 7, 11, 77], [1, 2, 3, 6, 13, 26, 39, 78], [1, 79], [1, 2, 4, 5, 8, 10, 16, 20, 40, 80], [1, 3, 9, 27, 81], [1, 2, 41, 82], [1, 83], [1, 2, 3, 4, 6, 7, 12, 14, 21, 28, 42, 84], [1, 5, 17, 85], [1, 2, 43, 86], [1, 3, 29, 87], [1, 2, 4, 8, 11, 22, 44, 88], [1, 89], [1, 2, 3, 5, 6, 9, 10, 15, 18, 30, 45, 90], [1, 7, 13, 91], [1, 2, 4, 23, 46, 92], [1, 3, 31, 93], [1, 2, 47, 94], [1, 5, 19, 95], [1, 2, 3, 4, 6, 8, 12, 16, 24, 32, 48, 96], [1, 97], [1, 2, 7, 14, 49, 98], [1, 3, 9, 11, 33, 99], [1, 2, 4, 5, 10, 20, 25, 50, 100]]

候选1项集C~1~: 
{'1': 100, '2': 50, '3': 33, '4': 25, '5': 20, '6': 16, '7': 14, '8': 12, '9': 11, '10': 10, '11': 9, '12': 8, '13': 7, '14': 7, '15': 6, '16': 6, '17': 5, '18': 5, '19': 5, '20': 5, '21': 4, '22': 4, '23': 4, '24': 4, '25': 4, '26': 3, '27': 3, '28': 3, '29': 3, '30': 3, '31': 3, '32': 3, '33': 3, '34': 2, '35': 2, '36': 2, '37': 2, '38': 2, '39': 2, '40': 2, '41': 2, '42': 2, '43': 2, '44': 2, '45': 2, '46': 2, '47': 2, '48': 2, '49': 2, '50': 2, '51': 1, '52': 1, '53': 1, '54': 1, '55': 1, '56': 1, '57': 1, '58': 1, '59': 1, '60': 1, '61': 1, '62': 1, '63': 1, '64': 1, '65': 1, '66': 1, '67': 1, '68': 1, '69': 1, '70': 1, '71': 1, '72': 1, '73': 1, '74': 1, '75': 1, '76': 1, '77': 1, '78': 1, '79': 1, '80': 1, '81': 1, '82': 1, '83': 1, '84': 1, '85': 1, '86': 1, '87': 1, '88': 1, '89': 1, '90': 1, '91': 1, '92': 1, '93': 1, '94': 1, '95': 1, '96': 1, '97': 1, '98': 1, '99': 1, '100': 1}

频繁1项集L~1~: 
{'1': 100, '2': 50, '3': 33, '4': 25, '5': 20, '6': 16, '7': 14, '8': 12, '9': 11, '10': 10, '11': 9, '12': 8, '13': 7, '14': 7, '15': 6, '16': 6, '17': 5, '18': 5, '19': 5, '20': 5}

候选2项集C~2~: 
{'[1, 2]': 50, '[1, 3]': 33, '[1, 4]': 25, '[1, 5]': 20, '[1, 6]': 16, '[1, 7]': 14, '[1, 8]': 12, '[1, 9]': 11, '[1, 10]': 10, '[1, 11]': 9, '[1, 12]': 8, '[1, 13]': 7, '[1, 14]': 7, '[1, 15]': 6, '[1, 16]': 6, '[1, 17]': 5, '[1, 18]': 5, '[1, 19]': 5, '[1, 20]': 5, '[2, 3]': 16, '[2, 4]': 25, '[2, 5]': 10, '[2, 6]': 16, '[2, 7]': 7, '[2, 8]': 12, '[2, 9]': 5, '[2, 10]': 10, '[2, 11]': 4, '[2, 12]': 8, '[2, 13]': 3, '[2, 14]': 7, '[2, 15]': 3, '[2, 16]': 6, '[2, 17]': 2, '[2, 18]': 5, '[2, 19]': 2, '[2, 20]': 5, '[3, 4]': 8, '[3, 5]': 6, '[3, 6]': 16, '[3, 7]': 4, '[3, 8]': 4, '[3, 9]': 11, '[3, 10]': 3, '[3, 11]': 3, '[3, 12]': 8, '[3, 13]': 2, '[3, 14]': 2, '[3, 15]': 6, '[3, 16]': 2, '[3, 17]': 1, '[3, 18]': 5, '[3, 19]': 1, '[3, 20]': 1, '[4, 5]': 5, '[4, 6]': 8, '[4, 7]': 3, '[4, 8]': 12, '[4, 9]': 2, '[4, 10]': 5, '[4, 11]': 2, '[4, 12]': 8, '[4, 13]': 1, '[4, 14]': 3, '[4, 15]': 1, '[4, 16]': 6, '[4, 17]': 1, '[4, 18]': 2, '[4, 19]': 1, '[4, 20]': 5, '[5, 6]': 3, '[5, 7]': 2, '[5, 8]': 2, '[5, 9]': 2, '[5, 10]': 10, '[5, 11]': 1, '[5, 12]': 1, '[5, 13]': 1, '[5, 14]': 1, '[5, 15]': 6, '[5, 16]': 1, '[5, 17]': 1, '[5, 18]': 1, '[5, 19]': 1, '[5, 20]': 5, '[6, 7]': 2, '[6, 8]': 4, '[6, 9]': 5, '[6, 10]': 3, '[6, 11]': 1, '[6, 12]': 8, '[6, 13]': 1, '[6, 14]': 2, '[6, 15]': 3, '[6, 16]': 2, '[6, 17]': 0, '[6, 18]': 5, '[6, 19]': 0, '[6, 20]': 1, '[7, 8]': 1, '[7, 9]': 1, '[7, 10]': 1, '[7, 11]': 1, '[7, 12]': 1, '[7, 13]': 1, '[7, 14]': 7, '[7, 15]': 0, '[7, 16]': 0, '[7, 17]': 0, '[7, 18]': 0, '[7, 19]': 0, '[7, 20]': 0, '[8, 9]': 1, '[8, 10]': 2, '[8, 11]': 1, '[8, 12]': 4, '[8, 13]': 0, '[8, 14]': 1, '[8, 15]': 0, '[8, 16]': 6, '[8, 17]': 0, '[8, 18]': 1, '[8, 19]': 0, '[8, 20]': 2, '[9, 10]': 1, '[9, 11]': 1, '[9, 12]': 2, '[9, 13]': 0, '[9, 14]': 0, '[9, 15]': 2, '[9, 16]': 0, '[9, 17]': 0, '[9, 18]': 5, '[9, 19]': 0, '[9, 20]': 0, '[10, 11]': 0, '[10, 12]': 1, '[10, 13]': 0, '[10, 14]': 1, '[10, 15]': 3, '[10, 16]': 1, '[10, 17]': 0, '[10, 18]': 1, '[10, 19]': 0, '[10, 20]': 5, '[11, 12]': 0, '[11, 13]': 0, '[11, 14]': 0, '[11, 15]': 0, '[11, 16]': 0, '[11, 17]': 0, '[11, 18]': 0, '[11, 19]': 0, '[11, 20]': 0, '[12, 13]': 0, '[12, 14]': 1, '[12, 15]': 1, '[12, 16]': 2, '[12, 17]': 0, '[12, 18]': 2, '[12, 19]': 0, '[12, 20]': 1, '[13, 14]': 0, '[13, 15]': 0, '[13, 16]': 0, '[13, 17]': 0, '[13, 18]': 0, '[13, 19]': 0, '[13, 20]': 0, '[14, 15]': 0, '[14, 16]': 0, '[14, 17]': 0, '[14, 18]': 0, '[14, 19]': 0, '[14, 20]': 0, '[15, 16]': 0, '[15, 17]': 0, '[15, 18]': 1, '[15, 19]': 0, '[15, 20]': 1, '[16, 17]': 0, '[16, 18]': 0, '[16, 19]': 0, '[16, 20]': 1, '[17, 18]': 0, '[17, 19]': 0, '[17, 20]': 0, '[18, 19]': 0, '[18, 20]': 0, '[19, 20]': 0}

频繁2项集L~2~: 
{'[1, 2]': 50, '[1, 3]': 33, '[1, 4]': 25, '[1, 5]': 20, '[1, 6]': 16, '[1, 7]': 14, '[1, 8]': 12, '[1, 9]': 11, '[1, 10]': 10, '[1, 11]': 9, '[1, 12]': 8, '[1, 13]': 7, '[1, 14]': 7, '[1, 15]': 6, '[1, 16]': 6, '[1, 17]': 5, '[1, 18]': 5, '[1, 19]': 5, '[1, 20]': 5, '[2, 3]': 16, '[2, 4]': 25, '[2, 5]': 10, '[2, 6]': 16, '[2, 7]': 7, '[2, 8]': 12, '[2, 9]': 5, '[2, 10]': 10, '[2, 12]': 8, '[2, 14]': 7, '[2, 16]': 6, '[2, 18]': 5, '[2, 20]': 5, '[3, 4]': 8, '[3, 5]': 6, '[3, 6]': 16, '[3, 9]': 11, '[3, 12]': 8, '[3, 15]': 6, '[3, 18]': 5, '[4, 5]': 5, '[4, 6]': 8, '[4, 8]': 12, '[4, 10]': 5, '[4, 12]': 8, '[4, 16]': 6, '[4, 20]': 5, '[5, 10]': 10, '[5, 15]': 6, '[5, 20]': 5, '[6, 9]': 5, '[6, 12]': 8, '[6, 18]': 5, '[7, 14]': 7, '[8, 16]': 6, '[9, 18]': 5, '[10, 20]': 5}


频繁3项集L~3~: 
{1, 2, 3}, {1, 2, 4}, {1, 2, 5}, {1, 2, 6}, {1, 2, 7}, {1, 2, 8}, {1, 2, 9}, {1, 2, 10}, {1, 2, 12}, {1, 2, 14}, {1, 2, 16}, {1, 2, 18}, {1, 2, 20},
{1, 3, 4}, {1, 3, 5}, {1, 3, 6}, {1, 3, 9}, {1, 3, 12}, {1, 3, 15}, {1, 3, 18},
{1, 4, 5}, {1, 4, 6}, {1, 4, 8}, {1, 4, 10}, {1, 4, 12}, {1, 4, 16}, {1, 4, 20},
{1, 5, 10}, {1, 5, 15}, {1, 5, 20},
{1, 6, 9}, {1, 6, 12}, {1, 6, 18},
{1, 7, 14}, {1, 8, 16}, {1, 9, 18}, {1, 10, 20},
{2, 3, 4}, {2, 3, 6}, {2, 3, 9}, {2, 3, 12}, {2, 3, 18},
{2, 4, 5}, {2, 4, 6}, {2, 4, 8}, {2, 4, 10}, {2, 4, 12}, {2, 4, 16}, {2, 4, 20},
{2, 5, 10}, {2, 5, 20},
{2, 6, 9}, {2, 6, 12}, {2, 6, 18},
{2, 7, 14}, {2, 8, 16}, {2, 9, 18}, {2, 10, 20},
{3, 4, 12}, {3, 5, 15},
{4, 5, 10}, {4, 5, 20}, {4, 6, 12},
{5, 10, 20},
{6, 9, 18}

频繁4项集L~4~: 
{1, 2, 3, 4}, {1, 2, 3, 6}, {1, 2, 3, 9}, {1, 2, 3, 12}, {1, 2, 3, 18},
{1, 2, 4, 5}, {1, 2, 4, 6}, {1, 2, 4, 8}, {1, 2, 4, 10}, {1, 2, 4, 12}, {1, 2, 4, 16}, {1, 2, 4, 20},
{1, 2, 5, 10}, {1, 2, 5, 20}, {1, 2, 6, 9}, {1, 2, 6, 12}, {1, 2, 6, 18},
{1, 2, 7, 14}, {1, 2, 8, 16}, {1, 2, 9, 18}, {1, 2, 10, 20},
{1, 3, 4, 12}, {1, 3, 5, 15},
{1, 4, 5, 10}, {1, 4, 5, 20}, {1, 4, 6, 12},
{1, 5, 10, 20}, {1, 6, 9, 18}
{2, 3, 4, 12}, {2, 4, 5, 10}, {2, 4, 5, 20}, {2, 4, 6, 12},
{2, 5, 10, 20}, {2, 6, 9, 18}
{4, 5, 10, 20}



频繁5项集L~5~: 
{1, 2, 3, 4, 12}, {1, 2, 4, 5, 10}, {1, 2, 4, 5, 20}, {1, 2, 4, 6, 12}, {1, 2, 5, 10, 20}, {1, 2, 6, 9, 18},
{1, 4, 5, 10, 20}, {2, 4, 5, 10, 20}

频繁6项集L~6~: 
{1, 2, 4, 5, 10, 20}








(b)


购物篮T: 
[[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100], [2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100], [3, 6, 9, 12, 15, 18, 21, 24, 27, 30, 33, 36, 39, 42, 45, 48, 51, 54, 57, 60, 63, 66, 69, 72, 75, 78, 81, 84, 87, 90, 93, 96, 99], [4, 8, 12, 16, 20, 24, 28, 32, 36, 40, 44, 48, 52, 56, 60, 64, 68, 72, 76, 80, 84, 88, 92, 96, 100], [5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100], [6, 12, 18, 24, 30, 36, 42, 48, 54, 60, 66, 72, 78, 84, 90, 96], [7, 14, 21, 28, 35, 42, 49, 56, 63, 70, 77, 84, 91, 98], [8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96], [9, 18, 27, 36, 45, 54, 63, 72, 81, 90, 99], [10, 20, 30, 40, 50, 60, 70, 80, 90, 100], [11, 22, 33, 44, 55, 66, 77, 88, 99], [12, 24, 36, 48, 60, 72, 84, 96], [13, 26, 39, 52, 65, 78, 91], [14, 28, 42, 56, 70, 84, 98], [15, 30, 45, 60, 75, 90], [16, 32, 48, 64, 80, 96], [17, 34, 51, 68, 85], [18, 36, 54, 72, 90], [19, 38, 57, 76, 95], [20, 40, 60, 80, 100], [21, 42, 63, 84], [22, 44, 66, 88], [23, 46, 69, 92], [24, 48, 72, 96], [25, 50, 75, 100], [26, 52, 78], [27, 54, 81], [28, 56, 84], [29, 58, 87], [30, 60, 90], [31, 62, 93], [32, 64, 96], [33, 66, 99], [34, 68], [35, 70], [36, 72], [37, 74], [38, 76], [39, 78], [40, 80], [41, 82], [42, 84], [43, 86], [44, 88], [45, 90], [46, 92], [47, 94], [48, 96], [49, 98], [50, 100], [51], [52], [53], [54], [55], [56], [57], [58], [59], [60], [61], [62], [63], [64], [65], [66], [67], [68], [69], [70], [71], [72], [73], [74], [75], [76], [77], [78], [79], [80], [81], [82], [83], [84], [85], [86], [87], [88], [89], [90], [91], [92], [93], [94], [95], [96], [97], [98], [99], [100]]

候选1项集C~1~: 
{'1': 1, '2': 2, '3': 2, '4': 3, '5': 2, '6': 4, '7': 2, '8': 4, '9': 3, '10': 4, '11': 2, '12': 6, '13': 2, '14': 4, '15': 4, '16': 5, '17': 2, '18': 6, '19': 2, '20': 6, '21': 4, '22': 4, '23': 2, '24': 8, '25': 3, '26': 4, '27': 4, '28': 6, '29': 2, '30': 8, '31': 2, '32': 6, '33': 4, '34': 4, '35': 4, '36': 9, '37': 2, '38': 4, '39': 4, '40': 8, '41': 2, '42': 8, '43': 2, '44': 6, '45': 6, '46': 4, '47': 2, '48': 10, '49': 3, '50': 6, '51': 4, '52': 6, '53': 2, '54': 8, '55': 4, '56': 8, '57': 4, '58': 4, '59': 2, '60': 12, '61': 2, '62': 4, '63': 6, '64': 7, '65': 4, '66': 8, '67': 2, '68': 6, '69': 4, '70': 8, '71': 2, '72': 12, '73': 2, '74': 4, '75': 6, '76': 6, '77': 4, '78': 8, '79': 2, '80': 10, '81': 5, '82': 4, '83': 2, '84': 12, '85': 4, '86': 4, '87': 4, '88': 8, '89': 2, '90': 12, '91': 4, '92': 6, '93': 4, '94': 4, '95': 4, '96': 12, '97': 2, '98': 6, '99': 6, '100': 9}

频繁1项集L~1~: 
{'12': 6, '16': 5, '18': 6, '20': 6, '24': 8, '28': 6, '30': 8, '32': 6, '36': 9, '40': 8, '42': 8, '44': 6, '45': 6, '48': 10, '50': 6, '52': 6, '54': 8, '56': 8, '60': 12, '63': 6, '64': 7, '66': 8, '68': 6, '70': 8, '72': 12, '75': 6, '76': 6, '78': 8, '80': 10, '81': 5, '84': 12, '88': 8, '90': 12, '92': 6, '96': 12, '98': 6, '99': 6, '100': 9}

候选2项集C~2~: 
{'[1, 2]': 1, '[1, 3]': 1, '[1, 4]': 1, '[1, 5]': 1, '[1, 6]': 1, '[1, 7]': 1, '[1, 8]': 1, '[1, 9]': 1, '[1, 10]': 1, '[1, 11]': 1, '[1, 12]': 1, '[1, 13]': 1, '[1, 14]': 1, '[1, 15]': 1, '[1, 16]': 1, '[1, 17]': 1, '[1, 18]': 1, '[1, 19]': 1, '[1, 20]': 1, '[2, 3]': 1, '[2, 4]': 2, '[2, 5]': 1, '[2, 6]': 2, '[2, 7]': 1, '[2, 8]': 2, '[2, 9]': 1, '[2, 10]': 2, '[2, 11]': 1, '[2, 12]': 2, '[2, 13]': 1, '[2, 14]': 2, '[2, 15]': 1, '[2, 16]': 2, '[2, 17]': 1, '[2, 18]': 2, '[2, 19]': 1, '[2, 20]': 2, '[3, 4]': 1, '[3, 5]': 1, '[3, 6]': 2, '[3, 7]': 1, '[3, 8]': 1, '[3, 9]': 2, '[3, 10]': 1, '[3, 11]': 1, '[3, 12]': 2, '[3, 13]': 1, '[3, 14]': 1, '[3, 15]': 2, '[3, 16]': 1, '[3, 17]': 1, '[3, 18]': 2, '[3, 19]': 1, '[3, 20]': 1, '[4, 5]': 1, '[4, 6]': 2, '[4, 7]': 1, '[4, 8]': 3, '[4, 9]': 1, '[4, 10]': 2, '[4, 11]': 1, '[4, 12]': 3, '[4, 13]': 1, '[4, 14]': 2, '[4, 15]': 1, '[4, 16]': 3, '[4, 17]': 1, '[4, 18]': 2, '[4, 19]': 1, '[4, 20]': 3, '[5, 6]': 1, '[5, 7]': 1, '[5, 8]': 1, '[5, 9]': 1, '[5, 10]': 2, '[5, 11]': 1, '[5, 12]': 1, '[5, 13]': 1, '[5, 14]': 1, '[5, 15]': 2, '[5, 16]': 1, '[5, 17]': 1, '[5, 18]': 1, '[5, 19]': 1, '[5, 20]': 2, '[6, 7]': 1, '[6, 8]': 2, '[6, 9]': 2, '[6, 10]': 2, '[6, 11]': 1, '[6, 12]': 4, '[6, 13]': 1, '[6, 14]': 2, '[6, 15]': 2, '[6, 16]': 2, '[6, 17]': 1, '[6, 18]': 4, '[6, 19]': 1, '[6, 20]': 2, '[7, 8]': 1, '[7, 9]': 1, '[7, 10]': 1, '[7, 11]': 1, '[7, 12]': 1, '[7, 13]': 1, '[7, 14]': 2, '[7, 15]': 1, '[7, 16]': 1, '[7, 17]': 1, '[7, 18]': 1, '[7, 19]': 1, '[7, 20]': 1, '[8, 9]': 1, '[8, 10]': 2, '[8, 11]': 1, '[8, 12]': 3, '[8, 13]': 1, '[8, 14]': 2, '[8, 15]': 1, '[8, 16]': 4, '[8, 17]': 1, '[8, 18]': 2, '[8, 19]': 1, '[8, 20]': 3, '[9, 10]': 1, '[9, 11]': 1, '[9, 12]': 2, '[9, 13]': 1, '[9, 14]': 1, '[9, 15]': 2, '[9, 16]': 1, '[9, 17]': 1, '[9, 18]': 3, '[9, 19]': 1, '[9, 20]': 1, '[10, 11]': 1, '[10, 12]': 2, '[10, 13]': 1, '[10, 14]': 2, '[10, 15]': 2, '[10, 16]': 2, '[10, 17]': 1, '[10, 18]': 2, '[10, 19]': 1, '[10, 20]': 4, '[11, 12]': 1, '[11, 13]': 1, '[11, 14]': 1, '[11, 15]': 1, '[11, 16]': 1, '[11, 17]': 1, '[11, 18]': 1, '[11, 19]': 1, '[11, 20]': 1, '[12, 13]': 1, '[12, 14]': 2, '[12, 15]': 2, '[12, 16]': 3, '[12, 17]': 1, '[12, 18]': 4, '[12, 19]': 1, '[12, 20]': 3, '[13, 14]': 1, '[13, 15]': 1, '[13, 16]': 1, '[13, 17]': 1, '[13, 18]': 1, '[13, 19]': 1, '[13, 20]': 1, '[14, 15]': 1, '[14, 16]': 2, '[14, 17]': 1, '[14, 18]': 2, '[14, 19]': 1, '[14, 20]': 2, '[15, 16]': 1, '[15, 17]': 1, '[15, 18]': 2, '[15, 19]': 1, '[15, 20]': 2, '[16, 17]': 1, '[16, 18]': 2, '[16, 19]': 1, '[16, 20]': 3, '[17, 18]': 1, '[17, 19]': 1, '[17, 20]': 1, '[18, 19]': 1, '[18, 20]': 2, '[19, 20]': 1}

频繁2项集L~2~: 
Ø



##  !习题6.2.7
候选集空间开销=$C_2M^2$×4bits=4M(2M-1) bits。

频繁项集空间开销=3×$C_N^2$×4bits=6N(N-1) bits。


总开销=4M(2M-1)+6N(N-1) bits。


##   习题6.3.1

( a )

| 项   | 支持度 |
| ---- | ------ |
| 1    | 4      |
| 2    | 6      |
| 3    | 8      |
| 4    | 8      |
| 5    | 6      |
| 6    | 4      |



| 项对   | 支持度 |
| ------ | ------ |
| {1, 2} | 2      |
| {1, 3} | 3      |
| {1, 4} | 2      |
| {1, 5} | 1      |
| {1, 6} | 0      |
| {2, 3} | 3      |
| {2, 4} | 4      |
| {2, 5} | 2      |
| {2, 6} | 1      |
| {3, 4} | 4      |
| {3, 5} | 4      |
| {3, 6} | 2      |
| {4, 5} | 3      |
| {4, 6} | 3      |
| {5, 6} | 2      |



( b )

| 项对   | 桶编号 |
| ------ | ------ |
| {1, 2} | 2      |
| {1, 3} | 3      |
| {1, 4} | 4      |
| {1, 5} | 5      |
| {1, 6} | 6      |
| {2, 3} | 6      |
| {2, 4} | 8      |
| {2, 5} | 10     |
| {2, 6} | 1      |
| {3, 4} | 1      |
| {3, 5} | 4      |
| {3, 6} | 7      |
| {4, 5} | 9      |
| {4, 6} | 2      |
| {5, 6} | 8      |

( c )

由上述结果可得：

| 项对   | 支持度 | 桶编号 |
| ------ | ------ | ------ |
| {1, 2} | 2      | 2      |
| {1, 3} | 3      | 3      |
| {1, 4} | 2      | 4      |
| {1, 5} | 1      | 5      |
| {1, 6} | 0      | 6      |
| {2, 3} | 3      | 6      |
| {2, 4} | 4      | 8      |
| {2, 5} | 2      | 10     |
| {2, 6} | 1      | 1      |
| {3, 4} | 4      | 1      |
| {3, 5} | 4      | 4      |
| {3, 6} | 2      | 7      |
| {4, 5} | 3      | 9      |
| {4, 6} | 3      | 2      |
| {5, 6} | 2      | 8      |

于是：


| 桶编号 | 频繁度 |
| ------ | ------ |
| 0      | 0      |
| 1      | 5      |
| 2      | 5      |
| 3      | 3      |
| 4      | 6      |
| 5      | 1      |
| 6      | 3      |
| 7      | 2      |
| 8      | 6      |
| 9      | 3      |
| 10     | 2      |



因为支持度阈值为4，所以，桶1，2，4，8是频繁的。


( d )



| 项对   | 支持度 | 桶编号 |
| ------ | ------ | ------ |
| {1, 2} | 2      | 2      |
| {1, 4} | 2      | 4      |
| {2, 4} | 4      | 8      |
| {2, 6} | 1      | 1      |
| {3, 4} | 4      | 1      |
| {3, 5} | 4      | 4      |
| {4, 6} | 3      | 2      |
| {5, 6} | 2      | 8      |

在PCY算法的第二次扫描中，项对{1, 2}，{1, 4}，{2, 4}，{2, 6}，{3, 4}，{3, 5}，{4, 6}，{5, 6}会被计数。

##  习题6.3.2

第二次扫描：

| 项对   | 支持度 | 桶编号 |
| ------ | ------ | ------ |
| {1, 2} | 2      | 2      |
| {1, 3} | 3      | 3      |
| {1, 4} | 2      | 4      |
| {1, 5} | 1      | 5      |
| {1, 6} | 0      | 6      |
| {2, 3} | 3      | 6      |
| {2, 4} | 4      | 8      |
| {2, 5} | 2      | 1      |
| {2, 6} | 1      | 3      |
| {3, 4} | 4      | 3      |
| {3, 5} | 4      | 6      |
| {3, 6} | 2      | 0      |
| {4, 5} | 3      | 2      |
| {4, 6} | 3      | 6      |
| {5, 6} | 2      | 3      |

于是：


| 桶编号 | 频繁度 |
| ------ | ------ |
| 0      | 2      |
| 1      | 2      |
| 2      | 5      |
| 3      | 11     |
| 4      | 2      |
| 5      | 1      |
| 6      | 10     |
| 7      | 0      |
| 8      | 4      |

因为支持度阈值为4，所以，桶2，3，6，8是频繁的。


在多阶段算法的第二次扫描中，项对{1, 2}，{2, 4}，{2, 6}，{3, 4}，{3, 5}，{4, 5}，{5, 6}会被计数。


第二次扫描减少了候选对集合的数目。

##  习题6.3.3


| 项   | 支持度 |
| ---- | ------ |
| 1    | 4      |
| 2    | 6      |
| 3    | 8      |
| 4    | 8      |
| 5    | 6      |
| 6    | 4      |

| 项对   | 支持度 | 桶1编号 | 桶2编号 |
| ------ | ------ | ------- | ------- |
| {1, 2} | 2      | 2       | 0       |
| {1, 3} | 3      | 0       | 0       |
| {1, 4} | 2      | 3       | 0       |
| {1, 5} | 1      | 1       | 0       |
| {1, 6} | 0      | 4       | 0       |
| {2, 3} | 3      | 2       | 3       |
| {2, 4} | 4      | 0       | 4       |
| {2, 5} | 2      | 3       | 0       |
| {2, 6} | 1      | 1       | 1       |
| {3, 4} | 4      | 2       | 3       |
| {3, 5} | 4      | 0       | 0       |
| {3, 6} | 2      | 3       | 2       |
| {4, 5} | 3      | 2       | 0       |
| {4, 6} | 3      | 0       | 3       |
| {5, 6} | 2      | 2       | 4       |



于是：

| 桶编号 | 桶1频繁度 | 桶2频繁度 |
| ------ | --------- | --------- |
| 0      | 4         | 8         |
| 1      | 2         | 1         |
| 2      | 5         | 1         |
| 3      | 3         | 3         |
| 4      | 1         | 2         |

支持度为2时，有5个项对会被计数，小于PCY。

故，支持度阈值至少为2。


##  !习题6.3.4
项名称到整数耗费存储空间：10^6^×4 bits=4×10^6 bits。

项计数值耗费存储空间：8×10^6^ bits。


桶计数哈希表耗费存储空间：P×4 bits=4P bits。

这三个结构共同存储在内存中，它们之和不能超过内存大小S，即：4×10^6^+8×10^6^+4P≤S

故，P≤(S-1.2×10^7^)/4。


##  !习题6.3.5


多哈希算法能减少内存需求。


第一次扫描中使用的最优哈希表数目是(S-1.2×10^7^)/8P。
##  !习题6.3.6
多阶段算法第三次扫描中的期望候选项对数是(S-1.2×10^7^)/128P。


##  习题6.4.1


反例边界：{A, B, C}，{E, F}，{G}，{H}。


##  习题6.4.2
( a )


样本数据上的频繁项集是{1}，{2}，{3}，{4}，{5}，{6}，{1, 2}，{2, 3}，{3, 4}，{4, 5}，{5, 6}，{1, 2, 3}，{2, 3, 4}，{3, 4, 5}，{4, 5, 6}。

( b )

反例边界是{1, 4}，{1, 5}，{1, 6}，{2, 5}，{2, 6}，{3, 6}。



( c )



整个数据集扫描后的结果是：

1. 样本数据上的频繁项集{1}，{2}，{3}，{4}，{5}，{6}，{1, 2}，{2, 3}，{3, 4}，{4, 5}，{5, 6}，{1, 2, 3}，{2, 3, 4}，{3, 4, 5}，{4, 5, 6}，以及它们各自的计数值。
2. 反例边界的计数值，都为0。

反例边界的计数值都为0，说明在反例边界中没有一个项集在整个数据集上是频繁的。



##  !!习题6.4.3

单个文件中出现项i的概率p=s/n。


项i频繁的概率为：

![在这里插入图片描述](https://img-blog.csdnimg.cn/259ffaaebc184381bb666296c4ae4ccd.png)
##  !!习题6.5.1

我们将对{i, j}进行评分的时间比例是(1-c)^p^。

##  !习题7.1.1
![在这里插入图片描述](https://img-blog.csdnimg.cn/db031bec614b46e390e8e0966b7ee278.png)

##  !!习题7.1.2


![在这里插入图片描述](https://img-blog.csdnimg.cn/bfc3a4e6c3ba4a3a9c16464979389dc7.png)


##  !习题7.1.3

夹角余弦计算公式中分子的值满足均值为0的正态分布。



当d不断增大时，向量夹角余弦的期望值不变。


##  习题7.2.1

初始点集为：{1, 4, 9, 16, 25, 36, 49, 64, 81}。

| 趟数 | 点集                             | 说明                                        |
| ---- | -------------------------------- | ------------------------------------------- |
| 1    | {2.5, 9, 16, 25, 36, 49, 64, 81} | 1和4距离最近，合并，质心为2.5               |
| 2    | {5.75, 16, 25, 36, 49, 64, 81}   | 2.5和9距离最近，合并，质心为5.75            |
| 3    | {5.75, 20.5, 36, 49, 64, 81}     | 16和25距离最近，合并，质心为20.5            |
| 4    | {5.75, 20.5, 42.5, 64, 81}       | 36和49距离最近，合并，质心为42.5            |
| 5    | {13.125, 42.5, 64, 81}           | 5.75和20.5距离最近，合并，质心为13.125      |
| 6    | {13.125, 42.5, 72.5}             | 64和81距离最近，合并，质心为72.5            |
| 7    | {27.8125, 72.5}                  | 13.125和42.5距离最近，合并，质心为27.8125   |
| 8    | {50.15625}                       | 27.8125和72.5距离最近，合并，质心为50.15625 |


##  习题7.2.2
![在这里插入图片描述](https://img-blog.csdnimg.cn/0ae89b91010a472e95c578d0f3492d57.jpeg)



(a)




![在这里插入图片描述](https://img-blog.csdnimg.cn/a6bf922552b84a0e82cb6cb9d8767175.png)



(b)





![在这里插入图片描述](https://img-blog.csdnimg.cn/fbff62cb21f84c2b8663d060532771b6.png)







##  习题7.2.3



![在这里插入图片描述](https://img-blog.csdnimg.cn/7e75c3d4728243ed9f3c3f0b2aea9bb1.png)
##  习题7.2.4

(a)


![在这里插入图片描述](https://img-blog.csdnimg.cn/519da1ca5f644fb788202984547278e5.png)


若合并簇1和簇2，质心为(31/7, 44/7)，半径为4.926，结果为0.7037。


若合并簇1和簇3，质心为(8, 29/8)，半径为6.2162，结果为0.7770。



若合并簇2和簇3，质心为(25/3, 19/3)，半径为5.6765，结果为0.6307。



这些结果都大于各个簇的半径和簇点数的商，说明簇不应该合并。




(b)










![在这里插入图片描述](https://img-blog.csdnimg.cn/30c35ec2c31146c0a5b4c13d9fa4bba6.png)






若合并簇1和簇2，直径为9.4340，结果为1.3477。


若合并簇1和簇3，直径为10.7703，结果为1.3463。



若合并簇2和簇3，直径为10.6301，结果为1.1811。



这些结果都大于各个簇的直径和簇点数的商，说明簇不应该合并。

##  习题7.2.5
![在这里插入图片描述](https://img-blog.csdnimg.cn/c684a399da874fb98eb1796a0af7fc07.png)





##  !习题7.2.6



![在这里插入图片描述](https://img-blog.csdnimg.cn/c8be4d5995244769a21602bddbe0bea7.png)


按距离和，我们选a或b或c作为中心点。


按最大距离最小，我们选a或b或c作为中心点。


只要选的中心点不同，就满足题意。
##  习题7.3.1

选择的第一个点是(3, 4)，剩下的2个点是(12, 6)，(4, 10)。

##  !!习题7.3.2
簇1：{(2, 2), (3, 4)}

簇2：{(4, 8), (6, 8), (4, 10)}

簇3：{(9, 3), (10, 5), (11, 4), (12, 3)}



三个簇的直径分别是√5、2√2、3。


最小簇间距离分别是√17、5、√37。




一般地，当最小簇间距离是簇的直径的几倍时，簇的合并可以停止了。

采用最大距离选择初始点，在簇合并结束后，初始点在相同的簇中的概率为0。


##  !习题7.3.3


点集：{(-1, 0), (1, 0), (0, -1), (0, 1), (0, 0)}


按7.3.2节的方法初始化5个簇，再进行簇的合并，最后簇{(0, 0)}重分配到另一个簇中。


##  习题7.3.4


(a)




![在这里插入图片描述](https://img-blog.csdnimg.cn/b1a599b986b64c1fb380d865c4ab7778.png)



(b)









![在这里插入图片描述](https://img-blog.csdnimg.cn/bd57a686fe8348bf958e7a826119e58a.png)




##  习题7.3.5




![在这里插入图片描述](https://img-blog.csdnimg.cn/4cb994b8a4d54c6d93d238a254f1c64b.png)
##  习题7.4.1


![在这里插入图片描述](https://img-blog.csdnimg.cn/308d855b90c047cb8912231f57cdce5f.png)
##  习题7.5.1


簇中点的数目N=12。

簇的中心点(10, 5)。

簇中心点的ROWSUM=342。

k=2，离簇中心点最近的2个点为(9, 3)和(11, 4)，它们的ROWSUM分别为352、446。


k=2，离簇中心点最远的2个点为(2, 2)和(4, 10)，它们的ROWSUM分别为688、604。

##  习题7.5.2

簇半径为：




![在这里插入图片描述](https://img-blog.csdnimg.cn/b7e69ead115547dd9a46d41ca998e199.png)



##  习题7.6.1



桶的初始化：


![在这里插入图片描述](https://img-blog.csdnimg.cn/0e807f1059f842debbb44454e0158dc8.png)

>注：这只是一种初始化方法。



从右到左，按k-mean算法聚类，k=3。



| 桶序号 | 质心    | 簇中点数目 |
| ------ | ------- | ---------- |
| 1      | 48      | 3          |
| 2      | 54      | 3          |
| 3      | 50.1667 | 6          |
| 4      | 45.6667 | 6          |
| 5      | 未知    | 12         |

合并后，

| 桶序号 | 质心    | 簇中点数目 |
| ------ | ------- | ---------- |
| 1      | 51      | 6          |
| 2      | 47.9167 | 12         |
| 3      | 未知    | 12         |


##  习题7.6.2

最佳质心为48。

##  !习题8.2.1
在线算法：“立即购买滑雪板”。

设天数为x，当天数小于等于10时，竞争率为x/10；当天数大于10时，竞争率为1。



##  习题8.3.1


![在这里插入图片描述](https://img-blog.csdnimg.cn/9e4c3e33fbff4e4b9af47daba8976a89.jpeg)
##  !习题8.3.2
G~4~有4个完美匹配。


G~5~有2个完美匹配。

##  !习题8.3.3

对于图8-1来说，只有一个完美匹配，有4*3*2*1=24种顺序。


简单检测方法：

1. 若4不和a匹配，则一定不是完美匹配；
2. 若2不和b匹配，则一定不是完美匹配；
3. 若满足4和a匹配，2和b匹配，还需要1-c和3-d，该匹配才是完美匹配。



##  习题8.4.1
!(a)

最差情况：

x-B
x-C
y-B
y-C

此时分配到了4个。

其他情况查询分配数大于等于4。

!!(b)

查询序列：yyzz

最优离线算法：2个y分配给B，2个z分配给C，收益为4。

贪心算法：2个y分配给C，收益为2，是最优离线算法的一半。




##  !!习题8.4.2

不会。

##  !习题8.4.3




假定有两个广告商A~1~和A~2~以及一个查询q，q的出价及预算为：


| 广告商 | 出价     | 预算 |
| ------ | -------- | ---- |
| A~1~   | a（->0） | c    |
| A~2~   | b（>>a） | d    |

其中，c>d在查询过程中一直成立。

设查询q的次数为x。此时，最优的离线算法会把所有的查询分配给A~2~，而Balance算法会把所有的查询分配给A~1~，竞争率c=(x*a)/(x*b)=a/b≈0。

##  习题9.2.1


向量A，B，C：

| 向量 | 处理器速度 | 磁盘大小 | 内存大小 |
| ---- | ---------- | -------- | -------- |
| A    | 3.06       | 500α     | 6β       |
| B    | 2.68       | 320α     | 4β       |
| C    | 2.92       | 640α     | 6β       |

a)


| 向量组合 | 夹角余弦                                                     |
| -------- | ------------------------------------------------------------ |
| A-B      | $\frac{8.2008+160000α^2+24β^2}{\sqrt{3.06^2+250000α^2+36β^2}*\sqrt{2.68^2+102400α^2+16β^2}}$ |
| A-C      | $\frac{8.9352+320000α^2+36β^2}{\sqrt{3.06^2+250000α^2+36β^2}*\sqrt{2.92^2+409600α^2+36β^2}}$ |
| B-C      | $\frac{7.8256+204800α^2+24β^2}{\sqrt{2.68^2+102400α^2+16β^2}*\sqrt{2.92^2+409600α^2+36β^2}}$ |

b)

若α=β=1，则：

| 向量组合 | 夹角余弦 | 夹角    |
| -------- | -------- | ------- |
| A-B      | 0.999997 | 0.1403° |
| A-C      | 0.999995 | 0.1812° |
| B-C      | 0.999988 | 0.2807° |


c)

若α=0.01，β=0.5，则：

| 向量组合 | 夹角余弦 | 夹角     |
| -------- | -------- | -------- |
| A-B      | 0.990881 | 7.7436°  |
| A-C      | 0.991555 | 7.4515°  |
| B-C      | 0.969178 | 14.2623° |

!(d)

第一分量的平均值=(3.06+2.68+2.92)/3=2.886667，放缩变换因子为1。

第二分量的平均值=(500+320+640)/3=486.6667，放缩变换因子α=2.886667*1/486.6667=0.0059。

第二分量的平均值=(6+4+6)/3=5.333333，放缩变换因子β=2.886667*1/5.333333=0.5413。

则：

| 向量组合 | 夹角余弦 | 夹角     |
| -------- | -------- | -------- |
| A-B      | 0.9899   | 8.1704°  |
| A-C      | 0.9916   | 7.4542°  |
| B-C      | 0.9693   | 14.2265° |

##  习题9.2.2

(a)

归一化前：

| 向量 | 处理器速度 | 磁盘大小 | 内存大小 |
| ---- | ---------- | -------- | -------- |
| A    | 3.06       | 500      | 6        |
| B    | 2.68       | 320      | 4        |
| C    | 2.92       | 640      | 6        |


归一化后：

| 向量 | 处理器速度 | 磁盘大小  | 内存大小 |
| ---- | ---------- | --------- | -------- |
| A    | 0.1733     | 13.3333   | 0.6667   |
| B    | -0.2067    | -166.6667 | -1.3333  |
| C    | 0.0333     | 153.3333  | 0.6667   |

!!(b)

不会写，按放缩变换因子均为1来算：

| 向量组合 | 夹角余弦  | 夹角      |
| -------- | --------- | --------- |
| A-B      | 0.9989    | 2.7158°   |
| A-C      | -0.9991   | 177.5023° |
| B-C      | -0.999993 | 179.78°   |

##  习题9.2.3


(a)

| 计算机 | 归一化前 | 归一化后 |
| ------ | -------- | -------- |
| A      | 4        | 0.3333   |
| B      | 2        | -1.6667  |
| C      | 5        | 1.3333   |

(b)


评分为0.3333、-1.6667和1.3333的平均值0。

##  习题9.3.1

效用矩阵：
| 用户 | a    | b    | c    | d    | e    | f    | g    | h    |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| A    | 4    | 5    |      | 5    | 1    |      | 3    | 2    |
| B    |      | 3    | 4    | 3    | 1    | 2    | 1    |      |
| C    | 2    |      | 1    | 3    |      | 4    | 5    | 3    |


a)

| 组合 | Jaccard距离 |
| ---- | ----------- |
| A-B  | 1/2         |
| A-C  | 5/8         |
| B-C  | 1/2         |

b)

| 组合 | 余弦距离 |
| ---- | -------- |
| A-B  | 0.6010   |
| A-C  | 0.5311   |
| B-C  | 0.5139   |


c)

将评分3到5看成1，将评分1和评分2还有空白看成0。效用矩阵变为：
| 用户 | a    | b    | c    | d    | e    | f    | g    | h    |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| A    | 1    | 1    | 0    | 1    | 0    | 0    | 1    | 0    |
| B    | 0    | 1    | 1    | 1    | 0    | 0    | 0    | 0    |
| C    | 0    | 0    | 0    | 1    | 0    | 1    | 1    | 1    |

| 组合 | Jaccard距离 |
| ---- | ----------- |
| A-B  | 0           |
| A-C  | 0           |
| B-C  | 0           |

d)

| 组合 | 余弦距离 |
| ---- | -------- |
| A-B  | 0.5774   |
| A-C  | 0.5      |
| B-C  | 0.2887   |

e)

效用矩阵变为：
| 用户 | a      | b      | c      | d      | e       | f       | g       | h       |
| ---- | ------ | ------ | ------ | ------ | ------- | ------- | ------- | ------- |
| A    | 0.6667 | 1.6667 |        | 1.6667 | -2.3333 |         | -0.3333 | -1.3333 |
| B    |        | 0.6667 | 1.6667 | 0.6667 | -1.3333 | -0.3333 | -1.3333 |         |
| C    | -1     |        | -2     | 0      |         | 1       | 2       | 0       |

f)

| 组合 | 余弦距离 |
| ---- | -------- |
| A-B  | 0.5843   |
| A-C  | -0.1155  |
| B-C  | -0.7396  |

##  习题9.3.2

a)

将评分3到5看成1，将评分1和评分2还有空白看成0。效用矩阵变为：
| 用户 | a    | b    | c    | d    | e    | f    | g    | h    |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| A    | 1    | 1    | 0    | 1    | 0    | 0    | 1    | 0    |
| B    | 0    | 1    | 1    | 1    | 0    | 0    | 0    | 0    |
| C    | 0    | 0    | 0    | 1    | 0    | 1    | 1    | 1    |

b)

| 用户 | 簇1（f、h） | 簇2（a、e） | 簇3（b、c） | 簇4（d、g） |
| ---- | ----------- | ----------- | ----------- | ----------- |
| A    | 0           | 1/2         | 1/2         | 1           |
| B    | 0           | 0           | 1           | 1/2         |
| C    | 1           | 0           | 0           | 1           |

c)


| 组合 | 余弦距离 |
| ---- | -------- |
| A-B  | 0.7303   |
| A-C  | 0.5774   |
| B-C  | 0.3162   |

##  习题9.4.1
矩阵M：


$$
\begin{bmatrix}
5&2&4&4&3\\3&1&2&4&1\\2&&3&1&4\\2&5&4&3&5\\4&4&5&4&
\end{bmatrix}
$$

(a) u~32~


新的U、V矩阵如下所示：

$$
\begin{bmatrix}
1&1\\1&1\\1&z\\1&1\\1&1
\end{bmatrix}
×
\begin{bmatrix}
1&1&1&1&1\\1&1&1&1&1
\end{bmatrix}=
\begin{bmatrix}
2&2&2&2&2\\2&2&2&2&2\\z+1&z+1&z+1&z+1&z+1\\2&2&2&2&2\\2&2&2&2&2
\end{bmatrix}
$$

注意到矩阵乘积的结果中只有第三行才有变化，于是，当将UV和M进行比较时，唯一的RMSE变化来自第三行。

第三行对平方和计算的贡献是：

$(2-(z+1))^2+(3-(z+1))^2+(1-(z+1))^2+(4-(z+1))^2$

该表达式可以简化为：

$(1-z)^2+(2-z)^2+z^2+(3-z)^2$

令其导数为0，于是有：

$-2(1-z)-2(2-z)+2z-2(3-z)=0$

对上式化简有：

$-2(6-4z)=0$

于是，$z=1.5$。


(b) v~14~
>注：书上写的是v~41~，我觉得不对，是打印错误，下面按v~14~计算。

新的U、V矩阵如下所示：

$$
\begin{bmatrix}
1&1\\1&1\\1&1\\1&1\\1&1
\end{bmatrix}
×
\begin{bmatrix}
1&1&1&y&1\\1&1&1&1&1
\end{bmatrix}=
\begin{bmatrix}
2&2&2&y+1&2\\2&2&2&y+1&2\\2&2&2&y+1&2\\2&2&2&y+1&2\\2&2&2&y+1&2
\end{bmatrix}
$$

注意到矩阵乘积的结果中只有第四列才有变化，于是，当将UV和M进行比较时，唯一的RMSE变化来自第四列。

第四列对平方和计算的贡献是：

$(4-(y+1))^2+(4-(y+1))^2+(1-(y+1))^2+(3-(y+1))^2+(4-(y+1))^2$

该表达式可以简化为：

$(3-y)^2+(3-y)^2+y^2+(2-y)^2+(3-y)^2$

令其导数为0，于是有：

$-2(3-y)-2(3-y)+2y-2(2-y)-2(3-y)=0$

对上式化简有：

$-2(11-5y)=0$

于是，$y=2.2$。
##  习题9.4.2

矩阵M：


$$
\begin{bmatrix}
5&2&4&4&3\\3&1&2&4&1\\2&&3&1&4\\2&5&4&3&5\\4&4&5&4&
\end{bmatrix}
$$

对U、V的初始值都设为相同值x，新的U、V矩阵如下所示：

$$
\begin{bmatrix}
x&x\\x&x\\x&x\\x&x\\x&x
\end{bmatrix}
×
\begin{bmatrix}
x&x&x&x&x\\x&x&x&x&x
\end{bmatrix}=
\begin{bmatrix}
2x^2&2x^2&2x^2&2x^2&2x^2\\2x^2&2x^2&2x^2&2x^2&2x^2\\2x^2&2x^2&2x^2&2x^2&2x^2\\2x^2&2x^2&2x^2&2x^2&2x^2\\2x^2&2x^2&2x^2&2x^2&2x^2
\end{bmatrix}
$$


$$
M-UV=
\begin{bmatrix}
5-2x^2&2-2x^2&4-2x^2&4-2x^2&3-2x^2 \\
3-2x^2&1-2x^2&2-2x^2&4-2x^2&1-2x^2 
\\2-2x^2&&3-2x^2&1-2x^2&4 -2x^2
\\2-2x^2&5-2x^2&4-2x^2&3-2x^2&5 -2x^2
\\4-2x^2&4-2x^2&5-2x^2&4-2x^2&
\end{bmatrix}
$$

求M-NV的每一个元素的平方和，除以23再开方，得到RMSE。

当RMSE取得最小值时，x即为所求，为1.2769。



求解程序：



```matlab
syms x 

F = sqrt((3*(1-2*x^2)^2+4*(2-2*x^2)^2+4*(3-2*x^2)^2+8*(4-2*x^2)^2+4*(5-2*x^2)^2)/23);

Feq = diff(F);

Feq=@(x)eval(Feq);

[x,fval,exitflag] = fzero(Feq,rand())
```

##  习题9.4.3
矩阵M：


$$
\begin{bmatrix}
5&2&4&4&3\\3&1&2&4&1\\2&&3&1&4\\2&5&4&3&5\\4&4&5&4&
\end{bmatrix}
$$

a)



重新考虑u~11~的值，新的U、V矩阵如下所示：

$$
\begin{bmatrix}
x&1\\1&1\\1.178&1\\1&1\\1&1
\end{bmatrix}
×
\begin{bmatrix}
1.617&1&1&1&1\\1&1&1&1&1
\end{bmatrix}=
\begin{bmatrix}
1.617x+1 & x+1 & x+1 & x+1 & x+1 \\
2.617 & 2 & 2& 2& 2 \\
1.905 & 2.178 & 2.178 & 2.178 & 2.178 \\
2.617 & 2 & 2& 2& 2 \\
2.617 & 2 & 2& 2& 2
\end{bmatrix}
$$

注意到矩阵乘积的结果中只有第一行才有变化，于是，当将UV和M进行比较时，唯一的RMSE变化来自第一行。

第一行对平方和计算的贡献是：

$(5-(1.617x+1))^2+(2-(x+1))^2+(4-(x+1))^2+(4-(x+1))^2+(3-(x+1))^2$

该表达式可以简化为：

$(4-1.617x)^2+(1-x)^2+(3-x)^2+(3-x)^2+(2-x)^2$

令其导数为0，于是有：

$-2(4-1.617x)-2(1-x)-2(3-x)-2(3-x)-2(2-x)=0$

对上式化简有：

$-2(13-5.617x)=0$

于是，$x=2.314$。



b)

考虑u~52~的值，新的U、V矩阵如下所示：

$$
\begin{bmatrix}
2.314&1\\1&1\\1.178&1\\1&1\\1&x
\end{bmatrix}
×
\begin{bmatrix}
1.617&1&1&1&1\\1&1&1&1&1
\end{bmatrix}=
\begin{bmatrix}
4.7417 & 3.314 & 3.314 & 3.314 & 3.314 \\
2.617 & 2 & 2& 2& 2 \\
1.905 & 2.178 & 2.178 & 2.178 & 2.178 \\
2.617 & 2 & 2& 2& 2 \\
x+1.617 & x+1 & x+1 & x+1 & x+1
\end{bmatrix}
$$

注意到矩阵乘积的结果中只有第五行才有变化，于是，当将UV和M进行比较时，唯一的RMSE变化来自第五行。

第五行对平方和计算的贡献是：

$(4-(x+1.617))^2+(4-(x+1))^2+(5-(x+1))^2+(4-(x+1))^2$

该表达式可以简化为：

$(2.383-x)^2+(3-x)^2+(4-x)^2+(3-x)^2$

令其导数为0，于是有：

$-2(2.383-x)-2(3-x)-2(4-x)-2(3-x)=0$
	
对上式化简有：

$-2(12.383-4x)=0$

于是，$x=3.096$。


c)

考虑v~22~的值，新的U、V矩阵如下所示：

$$
\begin{bmatrix}
2.314&1\\1&1\\1.178&1\\1&1\\1&3.096
\end{bmatrix}
×
\begin{bmatrix}
1.617&1&1&1&1\\
1&x&1&1&1
\end{bmatrix}=
\begin{bmatrix}
4.742 & x+2.314 & 3.314 & 3.314 & 3.314 \\
2.617 & x+1 & 2& 2& 2 \\
1.905 & x+1.178 & 2.178 & 2.178 & 2.178 \\
2.617 & x+1 & 2& 2& 2 \\
4.713 & 3.096x+1 & 4.096 & 4.096 & 4.096
\end{bmatrix}
$$

注意到矩阵乘积的结果中只有第2列才有变化，于是，当将UV和M进行比较时，唯一的RMSE变化来自第2列。

第2列对平方和计算的贡献是：

$(2-(x+2.314))^2+(1-(x+1))^2+(5-(x+1))^2+(4-(3.096x+1))^2$

该表达式可以简化为：

$(-0.314-x)^2+x^2+(4-x)^2+(3-3.096x)^2$

令其导数为0，于是有：

$-2(-0.314-x)+2x-2(4-x)-2(3-3.096x)=0$
	
对上式化简有：

$-2(6.686-6.096x)=0$

于是，$x=1.097$。


##  习题9.4.4
将9.4.4节的$y$的公式中的$i$全换成$j$即可。

##  习题9.4.5

矩阵M：


$$
\begin{bmatrix}
5&2&4&4&3\\3&1&2&4&1\\2&&3&1&4\\2&5&4&3&5\\4&4&5&4
\end{bmatrix}
$$



a)

归一化处理后的矩阵M：




$$
\begin{bmatrix}
1.47 & -1.1375 & 0.07 & -0.825 \\
0.87 & -0.7375 & -0.53 & -1.425\\
-0.43 && 0.17 & 1.275\\
-1.73 & 1.6625 & -0.13 & 0.975\\
-0.18 & 0.2125 &  0.42 & 
\end{bmatrix}
$$


b)

归一化处理后的矩阵M：


$$
\begin{bmatrix}
1.45 & -1.35 & 0.05 & 0.45 &  -0.6\\
0.85 & -0.95 & -0.55 & 1.85 & -1.2\\
-0.3875 && 0.2125 & -1.3875 & 1.5625\\
-1.75 & 1.45 & -0.15 & -0.75 & 1.2\\
-0.2&0&0.4&-0.2
\end{bmatrix}
$$

可以看出，两种处理之后的结果不同。

##  习题10.1.1


a)

边代表Y和Z可以通过X来交流，他们很可能也是朋友。

XY和XZ之间的边说明：在原图G中，存在一条长度为2的从X到Z的路。


b)

![在这里插入图片描述](https://img-blog.csdnimg.cn/ec1507476a7042e8b67737785aeb1f4c.jpeg)
!c)

$d(XY)=d(X)+d(Y)-1$

!!(d)

$m(G')=d(G)/2$

!(e)

G'与G同构的例子：

![在这里插入图片描述](https://img-blog.csdnimg.cn/d96f52ec7cc04af78224522f5f172175.jpeg)


该题（图10-1）就是一个G'与G不同构的例子。


##  习题10.2.1


a)



![在这里插入图片描述](https://img-blog.csdnimg.cn/e6f2a3f1fa5d44e68244b3ed2e64f3fc.png)



b)

![在这里插入图片描述](https://img-blog.csdnimg.cn/71a1d08dffc6476db9fedf9c923a0b2c.png)
##  习题10.2.2

从图的结构来看，不难看出：

A、I、F对称，B、C、H、G、D、E对称。

因此，我们只需要计算A、B即可。


从A开始计算：


![在这里插入图片描述](https://img-blog.csdnimg.cn/77d3ddeada7d4091b6f68f0888c4f8b6.png)


从B开始计算：

![在这里插入图片描述](https://img-blog.csdnimg.cn/318764358b264ab2aace9cabd45d90f2.png)


于是，所有边的中介度如下所示：

![在这里插入图片描述](https://img-blog.csdnimg.cn/cd924a7b95aa4bf89682d4202e5c8836.png)

##  习题10.2.3

对边的中介度降序排序，首先是BH、EG、CD三条边，它们的中介度都是9.5。

删掉这三条边，我们得到了3个社区：{A, B, C}、{D, E, F}、{G, H, I}。


在剩下的边中，BC、HG、DE三条边，它们的中介度都是6.5。

删掉这三条边，我们得到的还是这3个社区：{A, B, C}、{D, E, F}、{G, H, I}。

最终结果：


![在这里插入图片描述](https://img-blog.csdnimg.cn/83aa97cc550b443bb7cfa91b69144104.png)